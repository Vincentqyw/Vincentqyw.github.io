<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/realcat-apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/realcat-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/realcat-32x32.png">
  <link rel="mask-icon" href="/images/realcat-safari-pinned-tab.svg" color="#222">
  <meta name="google-site-verification" content="u46QTaG_Dv3OZLpOBKYtqyuiNtIdnhSG5ASKoNvGBCM">
  <meta name="baidu-site-verification" content="MtcbwE45ft">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.vincentqin.tech","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.13.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"show_result":true,"style":"flat"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"waline","storage":true,"lazyload":true,"nav":null,"activeClass":"waline"},"stickytabs":true,"motion":{"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeIn","post_body":"fadeIn","coll_header":"fadeIn","sidebar":"fadeIn"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ETHZ ASLä¸Magicleapè”åä¹‹ä½œï¼ŒCVPR 2020 Oralï¼ˆè®ºæ–‡è§æ–‡æœ«ï¼‰ï¼Œä¸€ä½œæ˜¯æ¥è‡ªETHZçš„å®ä¹ ç”Ÿï¼ŒäºŒä½œæ˜¯å½“å¹´CVPR2018 SuperPointçš„ä½œè€…Daniel DeToneã€‚Sarlinå°ä¼™ä¹‹å‰åœ¨MagicLeapå®ä¹ ï¼Œåœ¨ETHZï¼ˆè‹é»ä¸–è”é‚¦ç†å·¥ï¼‰ ASL å®Œæˆç¡•å£«ï¼Œç›®å‰åœ¨ ETHZ CVGå°±è¯»åšå£«ï¼Œä¸æ˜¯TUMï¼ˆæ…•å°¼é»‘å·¥ä¸šå¤§å­¦ï¼‰çš„CVGã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="ğŸ“ç¬”è®°ï¼šSuperGlue:Learning Feature Matching with Graph Neural Networksè®ºæ–‡é˜…è¯»">
<meta property="og:url" content="https://www.vincentqin.tech/posts/superglue/index.html">
<meta property="og:site_name" content="RealCat">
<meta property="og:description" content="ETHZ ASLä¸Magicleapè”åä¹‹ä½œï¼ŒCVPR 2020 Oralï¼ˆè®ºæ–‡è§æ–‡æœ«ï¼‰ï¼Œä¸€ä½œæ˜¯æ¥è‡ªETHZçš„å®ä¹ ç”Ÿï¼ŒäºŒä½œæ˜¯å½“å¹´CVPR2018 SuperPointçš„ä½œè€…Daniel DeToneã€‚Sarlinå°ä¼™ä¹‹å‰åœ¨MagicLeapå®ä¹ ï¼Œåœ¨ETHZï¼ˆè‹é»ä¸–è”é‚¦ç†å·¥ï¼‰ ASL å®Œæˆç¡•å£«ï¼Œç›®å‰åœ¨ ETHZ CVGå°±è¯»åšå£«ï¼Œä¸æ˜¯TUMï¼ˆæ…•å°¼é»‘å·¥ä¸šå¤§å­¦ï¼‰çš„CVGã€‚">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-04-17T17:21:56.000Z">
<meta property="article:modified_time" content="2022-05-17T16:36:10.705Z">
<meta property="article:author" content="Vincent Qin">
<meta property="article:tag" content="SLAM">
<meta property="article:tag" content="ç‰¹å¾æå–">
<meta property="article:tag" content="Deep Learning">
<meta property="article:tag" content="ç¬”è®°">
<meta property="article:tag" content="è®ºæ–‡">
<meta property="article:tag" content="SuperGlue">
<meta property="article:tag" content="MagicLeap">
<meta property="article:tag" content="æ·±åº¦å­¦ä¹ ">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.vincentqin.tech/posts/superglue/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://www.vincentqin.tech/posts/superglue/","path":"posts/superglue/","title":"ğŸ“ç¬”è®°ï¼šSuperGlue:Learning Feature Matching with Graph Neural Networksè®ºæ–‡é˜…è¯»"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ğŸ“ç¬”è®°ï¼šSuperGlue:Learning Feature Matching with Graph Neural Networksè®ºæ–‡é˜…è¯» | RealCat</title>
  
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-97856334-1","only_pageview":true}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>





<link rel="dns-prefetch" href="https://comments.vincentqin.tech">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">RealCat</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Turn on, Tune in, Drop out</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">76</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">14</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">111</span></a></li><li class="menu-item menu-item-collections"><a href="/collections" rel="section"><i class="fa fa-diamond fa-fw"></i>Collections</a></li><li class="menu-item menu-item-guest_comments"><a href="/guestbook" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%91%98%E8%A6%81"><span class="nav-number">1.</span> <span class="nav-text">æ‘˜è¦</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C"><span class="nav-number">2.</span> <span class="nav-text">ç›¸å…³å·¥ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%80%E9%83%A8%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D"><span class="nav-number">2.1.</span> <span class="nav-text">å±€éƒ¨ç‰¹å¾åŒ¹é…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BE%E5%8C%B9%E9%85%8D"><span class="nav-number">2.2.</span> <span class="nav-text">å›¾åŒ¹é…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%B1%E5%BA%A6%E7%82%B9%E4%BA%91%E5%8C%B9%E9%85%8D"><span class="nav-number">2.3.</span> <span class="nav-text">æ·±åº¦ç‚¹äº‘åŒ¹é…</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A1%86%E6%9E%B6%E4%BB%A5%E5%8F%8A%E5%8E%9F%E7%90%86"><span class="nav-number">3.</span> <span class="nav-text">æ¡†æ¶ä»¥åŠåŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AC%E5%BC%8F%E5%8C%96"><span class="nav-number">3.1.</span> <span class="nav-text">å…¬å¼åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E5%8A%9Bgnn"><span class="nav-number">3.2.</span> <span class="nav-text">æ³¨æ„åŠ›GNN</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E5%BE%81%E7%82%B9encode"><span class="nav-number">3.2.1.</span> <span class="nav-text">ç‰¹å¾ç‚¹Encode</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E5%B1%82gnn"><span class="nav-number">3.2.2.</span> <span class="nav-text">å¤šå±‚GNN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#attentional-aggregation"><span class="nav-number">3.2.3.</span> <span class="nav-text">Attentional Aggregation</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%B1%82optimal-matching-layer"><span class="nav-number">3.3.</span> <span class="nav-text">åŒ¹é…å±‚ï¼ˆOptimal matching
layerï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%BE%97%E5%88%86%E9%A2%84%E6%B5%8B"><span class="nav-number">3.3.1.</span> <span class="nav-text">åŒ¹é…å¾—åˆ†é¢„æµ‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%81%AE%E6%8C%A1%E4%BB%A5%E5%8F%8A%E5%8F%AF%E8%A7%81%E6%80%A7"><span class="nav-number">3.3.2.</span> <span class="nav-text">é®æŒ¡ä»¥åŠå¯è§æ€§</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sinkhorn-algorithm"><span class="nav-number">3.3.3.</span> <span class="nav-text">Sinkhorn Algorithm</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#loss"><span class="nav-number">3.4.</span> <span class="nav-text">Loss</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C"><span class="nav-number">4.</span> <span class="nav-text">å®éªŒ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%BA%94%E7%9F%A9%E9%98%B5%E4%BC%B0%E8%AE%A1"><span class="nav-number">4.1.</span> <span class="nav-text">å•åº”çŸ©é˜µä¼°è®¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%A4%E5%86%85%E5%A4%96%E4%BD%8D%E5%A7%BF%E4%BC%B0%E8%AE%A1"><span class="nav-number">4.2.</span> <span class="nav-text">å®¤å†…å¤–ä½å§¿ä¼°è®¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%80%97%E6%97%B6"><span class="nav-number">4.3.</span> <span class="nav-text">ç½‘ç»œè€—æ—¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E5%A4%9A%E5%8C%B9%E9%85%8D%E7%BB%93%E6%9E%9C"><span class="nav-number">4.4.</span> <span class="nav-text">æ›´å¤šåŒ¹é…ç»“æœ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-number">5.</span> <span class="nav-text">ç»“è®º</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%B9%E8%BF%9B%E7%82%B9-update-2022.05.17"><span class="nav-number">6.</span> <span class="nav-text">æ”¹è¿›ç‚¹ (Update: 2022.05.17)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">7.</span> <span class="nav-text">å‚è€ƒ</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Vincent Qin"
      src="https://vincentqin.gitee.io/images/qin_small.png">
  <p class="site-author-name" itemprop="name">Vincent Qin</p>
  <div class="site-description" itemprop="description">Keep Your Curiosity</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">111</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Vincentqyw" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Vincentqyw" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:realcat@126.com" title="Email â†’ mailto:realcat@126.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>Email</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://vincentqin.gitee.io/images/qrcode_realcat.jpg" title="Wechat â†’ https:&#x2F;&#x2F;vincentqin.gitee.io&#x2F;images&#x2F;qrcode_realcat.jpg" rel="noopener" target="_blank"><i class="fab fa-weixin fa-fw"></i>Wechat</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/i_vincent/activities" title="Zhihu â†’ https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;i_vincent&#x2F;activities" rel="noopener" target="_blank"><i class="fab fa-quora fa-fw"></i>Zhihu</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/AlphaRealcat" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;AlphaRealcat" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/18136563" title="Bilibili â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;18136563" rel="noopener" target="_blank"><i class="fa fa-video-camera fa-fw"></i>Bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://bafybeic2jt62kpyh6cz2g4ngxs4kazojfw3dhx53mco3wc6f56dejty4xm.ipfs.infura-ipfs.io/" title="Web3.0 â†’ https:&#x2F;&#x2F;bafybeic2jt62kpyh6cz2g4ngxs4kazojfw3dhx53mco3wc6f56dejty4xm.ipfs.infura-ipfs.io" rel="noopener" target="_blank"><i class="link fa-fw"></i>Web3.0</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-dashboard"></i>
      Scholar
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://xxx.itp.ac.cn/" title="http:&#x2F;&#x2F;xxx.itp.ac.cn" rel="noopener" target="_blank">Arxiv-Mirror</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://arxiv-sanity.com/" title="http:&#x2F;&#x2F;arxiv-sanity.com&#x2F;" rel="noopener" target="_blank">Arxiv-sanity</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://openaccess.thecvf.com/menu.py" title="http:&#x2F;&#x2F;openaccess.thecvf.com&#x2F;menu.py" rel="noopener" target="_blank">CVF</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://paperswithcode.com/sota" title="https:&#x2F;&#x2F;paperswithcode.com&#x2F;sota" rel="noopener" target="_blank">Paper&Code</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://scihub.wikicn.top/" title="https:&#x2F;&#x2F;scihub.wikicn.top&#x2F;" rel="noopener" target="_blank">Scihub</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://ras.papercept.net/conferences/scripts/start.pl" title="http:&#x2F;&#x2F;ras.papercept.net&#x2F;conferences&#x2F;scripts&#x2F;start.pl" rel="noopener" target="_blank">RAS</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://openreview.net/" title="https:&#x2F;&#x2F;openreview.net&#x2F;" rel="noopener" target="_blank">OpenReview</a>
        </li>
    </ul>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-battery-three-quarters fa-fw"></i>
      Friends Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.wangpengan.com/" title="http:&#x2F;&#x2F;www.wangpengan.com&#x2F;" rel="noopener" target="_blank">Tensorboy</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://simtalk.cn/" title="http:&#x2F;&#x2F;simtalk.cn&#x2F;" rel="noopener" target="_blank">Simshang</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://sttomato.github.io/" title="https:&#x2F;&#x2F;sttomato.github.io" rel="noopener" target="_blank">Tomato</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://dfine.tech/" title="http:&#x2F;&#x2F;dfine.tech&#x2F;" rel="noopener" target="_blank">Newdee</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://cs-people.bu.edu/yfhu/" title="http:&#x2F;&#x2F;cs-people.bu.edu&#x2F;yfhu&#x2F;" rel="noopener" target="_blank">WhoIf</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://yulunzhang.com/" title="http:&#x2F;&#x2F;yulunzhang.com&#x2F;" rel="noopener" target="_blank">Yulun</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://sanglongbest.github.io/" title="https:&#x2F;&#x2F;sanglongbest.github.io&#x2F;" rel="noopener" target="_blank">YangLiu</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.erenship.com/" title="https:&#x2F;&#x2F;www.erenship.com&#x2F;" rel="noopener" target="_blank">Eren</a>
        </li>
    </ul>
  </div>

  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-briefcase"></i>
      Common Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://comments.vincentqin.tech/ui" title="https:&#x2F;&#x2F;comments.vincentqin.tech&#x2F;ui" rel="noopener" target="_blank">Comments</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://gitee.com/vincentqin/vincentqin" title="https:&#x2F;&#x2F;gitee.com&#x2F;vincentqin&#x2F;vincentqin" rel="noopener" target="_blank">Source</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.notion.so/realcat" title="https:&#x2F;&#x2F;www.notion.so&#x2F;realcat" rel="noopener" target="_blank">Notion</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.matrixcalculus.org/" title="http:&#x2F;&#x2F;www.matrixcalculus.org&#x2F;" rel="noopener" target="_blank">Calculus</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://emojipedia.org/" title="https:&#x2F;&#x2F;emojipedia.org&#x2F;" rel="noopener" target="_blank">Emoji</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://unstoppabledomains.com/" title="https:&#x2F;&#x2F;unstoppabledomains.com&#x2F;" rel="noopener" target="_blank">UD</a>
        </li>
    </ul>
  </div>




        </div>

      <div class="wechat_QR_code">
      <!-- äºŒç»´ç  -->
      <img src ="https://vincentqin.tech/blog-resources/qrcode_realcat.jpg">
      <span>Follow Me on Wechat</span>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://www.vincentqin.tech/posts/superglue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://vincentqin.gitee.io/images/qin_small.png">
      <meta itemprop="name" content="Vincent Qin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RealCat">
      <meta itemprop="description" content="Keep Your Curiosity">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ğŸ“ç¬”è®°ï¼šSuperGlue:Learning Feature Matching with Graph Neural Networksè®ºæ–‡é˜…è¯» | RealCat">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ğŸ“ç¬”è®°ï¼šSuperGlue:Learning Feature Matching with Graph Neural Networksè®ºæ–‡é˜…è¯»
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-04-18 01:21:56" itemprop="dateCreated datePublished" datetime="2020-04-18T01:21:56+08:00">2020-04-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-05-18 00:36:10" itemprop="dateModified" datetime="2022-05-18T00:36:10+08:00">2022-05-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Image-Matching/" itemprop="url" rel="index"><span itemprop="name">Image Matching</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline: </span>
  
    <a title="waline" href="/posts/superglue/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/posts/superglue/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-item" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="waline-pageview-count" data-path="/posts/superglue/"></span>
    </span>
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <script src="/assets/js/DPlayer.min.js"> </script><div class="note default"><p>ETHZ ASLä¸Magicleapè”åä¹‹ä½œï¼ŒCVPR 2020
Oralï¼ˆè®ºæ–‡è§æ–‡æœ«ï¼‰ï¼Œä¸€ä½œæ˜¯æ¥è‡ªETHZçš„å®ä¹ ç”Ÿï¼ŒäºŒä½œæ˜¯å½“å¹´CVPR2018
SuperPointçš„ä½œè€…Daniel
DeToneã€‚Sarlinå°ä¼™ä¹‹å‰åœ¨MagicLeapå®ä¹ ï¼Œåœ¨ETHZï¼ˆè‹é»ä¸–è”é‚¦ç†å·¥ï¼‰ ASL
å®Œæˆç¡•å£«ï¼Œç›®å‰åœ¨ ETHZ CVGå°±è¯»åšå£«ï¼Œä¸æ˜¯TUMï¼ˆæ…•å°¼é»‘å·¥ä¸šå¤§å­¦ï¼‰çš„CVGã€‚</p>
<!-- ![](/posts/superglue/freiburg_matches.gif) -->
</div>
<p><img data-src="https://vincentqin.gitee.io/posts/superglue/freiburg_matches.gif" /></p>
<span id="more"></span>
<p>æ³¨ï¼š</p>
<ol type="1">
<li>SuperPointå‚è§å¦å¤–ä¸€ç¯‡æ–‡ç« <a
href="https://www.vincentqin.tech/posts/superpoint/">ã€ŠSuperPoint:
Self-Supervised Interest Point Detection and Descriptionã€‹</a>ï¼Œ<a
target="_blank" rel="noopener" href="https://vincentqin.gitee.io/posts/superpoint/">å¤‡ç”¨é“¾æ¥</a>ã€‚</li>
<li>åæ–‡ä¸­åå¤æåˆ°çš„self-attention/cross-attentionï¼Œæˆ‘æš‚æ—¶ç¿»è¯‘æˆè‡ªæˆ‘æ³¨æ„åŠ›/äº¤å‰æ³¨æ„åŠ›ã€‚</li>
<li>æœ¬äººçŸ¥è¯†æ°´å¹³æœ‰é™ï¼Œå¦‚æœ‰é”™è¯¯è¯·åœ¨è¯„è®ºåŒºæŒ‡å‡ºã€‚å½“ç„¶ï¼Œæ²¡æœ‰é—®é¢˜ä¹Ÿå¯åˆ·åˆ·è¯„è®ºã€‚</li>
</ol>
<p>ä¸‹é¢æ˜¯ä¸€ä½œDaniel DeToneå…³äºSuperPointçš„è®²è§£(éœ€è¦ç§‘å­¦ä¸Šç½‘)ã€‚</p>
<iframe width="1283" height="731" src="https://www.youtube.com/embed/95Eysm0IeB0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<h2 id="æ‘˜è¦">æ‘˜è¦</h2>
<p>æœ¬æ–‡æå‡ºäº†ä¸€ç§èƒ½å¤ŸåŒæ—¶è¿›è¡Œç‰¹å¾åŒ¹é…ä»¥åŠæ»¤é™¤å¤–ç‚¹çš„ç½‘ç»œã€‚å…¶ä¸­ç‰¹å¾åŒ¹é…æ˜¯é€šè¿‡æ±‚è§£å¯å¾®åˆ†æœ€ä¼˜åŒ–è½¬ç§»é—®é¢˜ï¼ˆ
optimal transport
problemï¼‰æ¥è§£å†³ï¼›æœ¬æ–‡åŸºäºæ³¨æ„åŠ›æœºåˆ¶æå‡ºäº†ä¸€ç§å°†2Dç‰¹å¾ç‚¹ä»¥åŠèšåˆæœºåˆ¶ï¼Œè¿™ä½¿å¾—SuperGlueèƒ½å¤ŸåŒæ—¶æ„ŸçŸ¥æ½œåœ¨çš„3Dåœºæ™¯ä»¥åŠè¿›è¡Œç‰¹å¾åŒ¹é…ã€‚è¯¥ç®—æ³•ä¸ä¼ ç»Ÿçš„ï¼Œæ‰‹å·¥è®¾è®¡çš„ç‰¹å¾ç›¸æ¯”ï¼Œèƒ½å¤Ÿåœ¨å®¤å†…å¤–ç¯å¢ƒä¸­ä½å§¿ä¼°è®¡ä»»åŠ¡ä¸­å–å¾—æœ€å¥½çš„ç»“æœï¼Œè¯¥ç½‘ç»œèƒ½å¤Ÿåœ¨GPUä¸Šè¾¾åˆ°å®æ—¶ï¼Œé¢„æœŸèƒ½å¤Ÿé›†æˆåˆ°sfmä»¥åŠslamç®—æ³•ä¸­ã€‚</p>
<figure>
<img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_front.png"
alt="superglue_front" />
<figcaption aria-hidden="true">superglue_front</figcaption>
</figure>
<p>SuperGlueæ˜¯ä¸€ç§ç‰¹å¾åŒ¹é…ç½‘ç»œï¼Œå®ƒçš„è¾“å…¥æ˜¯2å¼ å›¾åƒä¸­ç‰¹å¾ç‚¹ä»¥åŠæè¿°å­ï¼ˆæ‰‹å·¥ç‰¹å¾æˆ–è€…æ·±åº¦å­¦ä¹ ç‰¹å¾å‡å¯ï¼‰ï¼Œè¾“å‡ºæ˜¯å›¾åƒç‰¹å¾ä¹‹é—´çš„åŒ¹é…å…³ç³»ã€‚</p>
<p>ä½œè€…è®¤ä¸ºå­¦ä¹ ç‰¹å¾åŒ¹é…å¯ä»¥è¢«è§†ä¸ºæ‰¾åˆ°ä¸¤ç°‡ç‚¹çš„å±€éƒ¨åˆ†é…å…³ç³»ã€‚ä½œè€…å—åˆ°äº†Transformerçš„å¯å‘ï¼ŒåŒæ—¶å°†self-å’Œcross-attentionåˆ©ç”¨ç‰¹å¾ç‚¹ä½ç½®ä»¥åŠå…¶è§†è§‰å¤–è§‚è¿›è¡ŒåŒ¹é…ã€‚</p>
<h2 id="ç›¸å…³å·¥ä½œ">ç›¸å…³å·¥ä½œ</h2>
<h3 id="å±€éƒ¨ç‰¹å¾åŒ¹é…">å±€éƒ¨ç‰¹å¾åŒ¹é…</h3>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_pre-1.png" />
ä¼ ç»Ÿçš„ç‰¹å¾å¯åˆ†5æ­¥èµ°ï¼š1)æå–ç‰¹å¾ç‚¹ï¼›2)è®¡ç®—æè¿°å­ï¼›3)æœ€è¿‘é‚»åŒ¹é…ï¼›4)æ»¤é™¤å¤–ç‚¹ï¼›5)æ±‚è§£å‡ ä½•çº¦æŸï¼›å…¶ä¸­æ»¤é™¤å¤–ç‚¹ä¸€æ­¥åŒ…æ‹¬ç‚¹æ–¹æ³•æœ‰ï¼šè®¡ç®—æœ€ä¼˜æ¬¡ä¼˜æ¯”ï¼ŒRANSACï¼Œäº¤å‰éªŒè¯ä»¥åŠneighborhood
consensusã€‚</p>
<p>æœ€è¿‘çš„ä¸€äº›å·¥ä½œä¸»è¦é›†ä¸­åœ¨è®¾è®¡ç‰¹å¼‚æ€§æ›´å¥½çš„ç¨€ç–ç‰¹å¾ä¸Šï¼Œè€Œå®ƒä»¬çš„åŒ¹é…ç®—æ³•ä»ç„¶ä¾èµ–äºNNç­‰ç­–ç•¥ï¼šåœ¨åšåŒ¹é…æ—¶å¹¶æ²¡æœ‰è€ƒè™‘ç‰¹å¾çš„ç»“æ„ç›¸ä¼¼æ€§ä»¥åŠå¤–è§‚ç›¸ä¼¼æ€§ã€‚</p>
<h3 id="å›¾åŒ¹é…">å›¾åŒ¹é…</h3>
<p>è¿™ç±»æ–¹æ³•å°†ç‰¹å¾çš„åŒ¹é…é—®é¢˜æè¿°æˆâ€œquadratic assignment
problemsâ€ï¼Œè¿™æ˜¯ä¸€ä¸ªNP-hardé—®é¢˜ï¼Œæ±‚è§£è¿™ç±»é—®é¢˜éœ€è¦å¤æ‚ä¸åˆ‡å®é™…çš„ç®—å­ã€‚åæ¥çš„ç ”ç©¶è€…å°†è¿™ä¸ªé—®é¢˜åŒ–ç®€æˆâ€œlinear
assignment
problemsâ€ï¼Œä½†ä»…ä»…ç”¨äº†ä¸€ä¸ªæµ…å±‚æ¨¡å‹ï¼Œç›¸æ¯”ä¹‹ä¸‹SuperGlueåˆ©ç”¨æ·±åº¦ç¥ç»ç½‘ç»œæ„å»ºäº†ä¸€ç§åˆé€‚çš„ä»£ä»·è¿›è¡Œæ±‚è§£ã€‚æ­¤å¤„éœ€è¦è¯´æ˜çš„æ˜¯å›¾åŒ¹é…é—®é¢˜å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§â€œ<em>optimal
transport</em>â€é—®é¢˜ï¼Œ<strong>å®ƒæ˜¯ä¸€ç§æœ‰æ•ˆä½†ç®€å•çš„è¿‘ä¼¼è§£çš„å¹¿ä¹‰çº¿æ€§åˆ†é…ï¼Œå³Sinkhornç®—æ³•</strong>ã€‚</p>
<h3 id="æ·±åº¦ç‚¹äº‘åŒ¹é…">æ·±åº¦ç‚¹äº‘åŒ¹é…</h3>
<p>ç‚¹äº‘åŒ¹é…çš„ç›®çš„æ˜¯é€šè¿‡åœ¨å…ƒç´ ä¹‹é—´èšé›†ä¿¡æ¯æ¥è®¾è®¡ç½®æ¢ç­‰ä»·æˆ–ä¸å˜å‡½æ•°ã€‚ä¸€äº›ç®—æ³•åŒç­‰çš„å¯¹å¾…è¿™äº›å…ƒç´ ï¼Œè¿˜æœ‰ä¸€äº›ç®—æ³•ä¸»è¦å…³æ³¨äºå…ƒç´ çš„å±€éƒ¨åæ ‡æˆ–è€…ç‰¹å¾ç©ºé—´ã€‚æ³¨æ„åŠ›æœºåˆ¶å¯ä»¥é€šè¿‡å…³æ³¨ç‰¹å®šçš„å…ƒç´ å’Œå±æ€§æ¥å®ç°å…¨å±€ä»¥åŠä¾èµ–äºæ•°æ®çš„å±€éƒ¨èšåˆï¼Œå› è€Œæ›´åŠ å…¨é¢å’Œçµæ´»ã€‚SuperGlueå€Ÿé‰´äº†è¿™ç§æ³¨æ„åŠ›æœºåˆ¶ã€‚</p>
<h2 id="æ¡†æ¶ä»¥åŠåŸç†">æ¡†æ¶ä»¥åŠåŸç†</h2>
<p>ç‰¹å¾åŒ¹é…å¿…é¡»æ»¡è¶³çš„ç¡¬æ€§è¦æ±‚æ˜¯ï¼š</p>
<blockquote>
<p>i)è‡³å¤šæœ‰1ä¸ªåŒ¹é…ç‚¹ï¼›ii)æœ‰äº›ç‚¹ç”±äºé®æŒ¡ç­‰åŸå› å¹¶æ²¡æœ‰åŒ¹é…ç‚¹ã€‚</p>
</blockquote>
<p>ä¸€ä¸ªæˆç†Ÿçš„ç‰¹å¾åŒ¹é…æ¨¡å‹åº”è¯¥åšåˆ°ï¼šæ—¢èƒ½å¤Ÿæ‰¾åˆ°ç‰¹å¾ä¹‹é—´çš„æ­£ç¡®åŒ¹é…ï¼Œåˆå¯ä»¥é‰´åˆ«é”™è¯¯åŒ¹é…ã€‚</p>
<figure>
<img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_arch.png"
alt="superglue_arch" />
<figcaption aria-hidden="true">superglue_arch</figcaption>
</figure>
<p>æ•´ä¸ªæ¡†æ¶ç”±ä¸¤ä¸ªä¸»è¦æ¨¡å—ç»„æˆï¼šæ³¨æ„åŠ›GNNä»¥åŠæœ€ä¼˜åŒ¹é…å±‚ã€‚å…¶ä¸­æ³¨æ„åŠ›GNNå°†ç‰¹å¾ç‚¹ä»¥åŠæè¿°å­ç¼–ç æˆä¸ºä¸€ä¸ªå‘é‡ï¼ˆè¯¥å‘é‡å¯ä»¥ç†è§£ä¸ºç‰¹å¾åŒ¹é…å‘é‡ï¼‰ï¼Œéšååˆ©ç”¨è‡ªæˆ‘æ³¨æ„åŠ›ä»¥åŠäº¤å‰æ³¨æ„åŠ›æ¥å›å¢å¼ºï¼ˆé‡å¤<span
class="math inline">\(L\)</span>æ¬¡ï¼‰è¿™ä¸ªå‘é‡<span
class="math inline">\(\mathbf{f}\)</span>çš„ç‰¹å¾åŒ¹é…æ€§èƒ½ï¼›éšåè¿›å…¥æœ€ä¼˜åŒ¹é…å±‚ï¼Œé€šè¿‡è®¡ç®—ç‰¹å¾åŒ¹é…å‘é‡çš„å†…ç§¯å¾—åˆ°åŒ¹é…åº¦å¾—åˆ†çŸ©é˜µï¼Œç„¶åé€šè¿‡Sinkhornç®—æ³•ï¼ˆè¿­ä»£<span
class="math inline">\(T\)</span>æ¬¡ï¼‰è§£ç®—å‡ºæœ€ä¼˜ç‰¹å¾åˆ†é…çŸ©é˜µã€‚</p>
<h3 id="å…¬å¼åŒ–">å…¬å¼åŒ–</h3>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_problem-definition.png" />
è¯¥éƒ¨åˆ†å¯¹ç‰¹å¾åŒ¹é…é—®é¢˜å»ºæ¨¡ã€‚ç»™å®šä¸¤å¼ å›¾ç‰‡<span
class="math inline">\(A,B\)</span>ï¼Œæ¯å¼ å›¾ç‰‡ä¸Šéƒ½æœ‰ç‰¹å¾ç‚¹ä½ç½®<span
class="math inline">\(\mathbf{p}\)</span>ä»¥åŠå¯¹åº”çš„æè¿°å­<span
class="math inline">\(\mathbf{d}\)</span>ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»å¸¸ç”¨<span
class="math inline">\((\mathbf{p},\mathbf{d})\)</span>æ¥è¡¨ç¤ºå›¾åƒç‰¹å¾ã€‚ç¬¬<span
class="math inline">\(i\)</span>ä¸ªç‰¹å¾å¯ä»¥è¡¨ç¤ºä¸º<span
class="math inline">\(\mathbf{p}_i:=(x,y,c)\)</span>ï¼Œå…¶ä¸­<span
class="math inline">\(c\)</span>è¡¨ç¤ºç‰¹å¾ç‚¹æå–ç½®ä¿¡åº¦ï¼Œ<span
class="math inline">\((x,y)\)</span>è¡¨ç¤ºç‰¹å¾åæ ‡ï¼›æè¿°å­å¯ä»¥è¡¨ç¤ºä¸º<span
class="math inline">\(\mathbf{d}_i \in
\mathbb{R}^{D}\)</span>ï¼Œå…¶ä¸­<span
class="math inline">\(D\)</span>è¡¨ç¤ºç‰¹å¾ç»´åº¦ï¼Œè¿™é‡Œçš„ç‰¹å¾å¯ä»¥æ˜¯CNNç‰¹å¾ï¼Œå¦‚SuperPointï¼Œæˆ–è€…æ˜¯ä¼ ç»Ÿç‰¹å¾SIFTã€‚å‡è®¾å›¾åƒ<span
class="math inline">\(A,B\)</span>åˆ†åˆ«æœ‰<span
class="math inline">\(M,N\)</span>ä¸ªç‰¹å¾ï¼Œå¯ä»¥è¡¨ç¤ºä¸º<span
class="math inline">\(\mathcal{A}:=\{1, \ldots, M\}\)</span>ä»¥åŠ<span
class="math inline">\(\mathcal{B}:=\{1, \ldots, N\}\)</span>ã€‚</p>
<p><strong>éƒ¨åˆ†åˆ†é…çŸ©é˜µ</strong>ï¼šçº¦æŸiï¼‰å’Œiiï¼‰æ„å‘³ç€å¯¹åº”å…³ç³»æ¥è‡ªä¸¤ç»„å…³é”®ç‚¹ä¹‹é—´çš„éƒ¨åˆ†åˆ†é…ã€‚æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªè½¯åˆ†é…çŸ©é˜µ<span
class="math inline">\(\mathbf{P} \in[0,1]^{M \times
N}\)</span>ï¼Œæ ¹æ®ä¸Šè¿°çº¦æŸï¼Œæˆ‘ä»¬æœ‰å¦‚ä¸‹å…³ç³»ï¼š <span
class="math display">\[
\mathbf{P} \mathbf{1}_{N} \leq \mathbf{1}_{M} \quad \text { and } \quad
\mathbf{P}^{\top} \mathbf{1}_{M} \leq \mathbf{1}_{N}
\]</span></p>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue-ot-1.jpg" /></p>
<blockquote>
<p>ä¸ºä½•ä¸Šå¼ä¸­ä½¿ç”¨ "<span class="math inline">\(\leq\)</span>" è€Œé
"<span class="math inline">\(=\)</span>"ï¼Ÿè¿™é‡Œå€¼å¾—è¯´æ˜ä¸€ä¸‹ã€‚</p>
</blockquote>
<p>é¦–å…ˆè¦ç†è§£åˆ†é…çŸ©é˜µ<span
class="math inline">\(\mathbf{P}\)</span>æ˜¯ä»€ä¹ˆã€‚<span
class="math inline">\(\mathbf{P}\)</span>çš„æ¯ä¸€è¡Œä»£è¡¨æ¥è‡ªäºå›¾<span
class="math inline">\(A\)</span>ä¸­çš„æŸä¸ªç‰¹å¾ç‚¹å¯¹åº”å›¾<span
class="math inline">\(B\)</span>çš„<span
class="math inline">\(N\)</span>ç§åŒ¹é…çš„å¯èƒ½æ€§ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå›¾<span
class="math inline">\(A\)</span>æœ‰3ä¸ªç‰¹å¾ç‚¹ï¼Œå›¾<span
class="math inline">\(B\)</span>æœ‰4ä¸ªç‰¹å¾ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆ†é…çŸ©é˜µçš„ç»´åº¦å°±æ˜¯<span
class="math inline">\(\mathbf{P} \in \mathbb{R}^{3 \times
4}\)</span>ã€‚å¯¹äºç¬¬0è¡Œï¼Œå³å›¾Açš„ç¬¬0å·ç‰¹å¾ç‚¹ï¼Œå®ƒå¯èƒ½åœ¨å›¾Bä¸­æœ‰4ä¸ªåŒ¹é…ç‚¹ï¼Œç”±ä¸Šå›¾ç§ç»™å‡ºçš„è½¯åˆ†é…çŸ©é˜µ<span
class="math inline">\(\mathbf{P}\)</span>çš„ç¬¬0è¡Œæ•°æ®å¯ä»¥çœ‹åˆ°ï¼Œæœ€å¤§æ˜¯æ•°å­—æ˜¯0.6ï¼Œå³å›¾<span
class="math inline">\(A\)</span>çš„ç¬¬0å·ç‰¹å¾ä¸å›¾Bçš„ç¬¬1å·ç‰¹å¾æ˜¯åŒ¹é…çš„ã€‚ç›¸åº”çš„ï¼Œå¯¹äº<span
class="math inline">\(\mathbf{P}\)</span>çš„ç¬¬0åˆ—ï¼Œæœ€å¤§æ˜¯æ•°å­—æ˜¯0.5ï¼Œå³å›¾<span
class="math inline">\(B\)</span>çš„ç¬¬0å·ç‰¹å¾ä¸å›¾<span
class="math inline">\(A\)</span>çš„ç¬¬1å·ç‰¹å¾æ˜¯åŒ¹é…çš„ï¼Œè¿™çœ‹èµ·æ¥éå¸¸åˆç†ã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ª<span
class="math inline">\(\mathbf{P}\)</span>æ˜¯ä¸€ä¸ªæ‰€è°“çš„â€œè½¯åˆ†é…â€çŸ©é˜µï¼Œæ‰€ä»¥å…¶ä¸­çš„å…ƒç´ å¹¶éæ˜¯ç»å¯¹çš„0æˆ–1ã€‚å¯¹äº<span
class="math inline">\(\mathbf{P}\)</span>è¿˜éœ€è¦æ»¡è¶³è§„å®šï¼šåœ¨ç†æƒ³æƒ…å†µä¸‹<span
class="math inline">\(\mathbf{P}\)</span>çš„è¡Œä¹‹å’Œæˆ–è€…åˆ—ä¹‹å’Œç­‰äº1ã€‚æ­¤å¤„çš„â€œç†æƒ³æƒ…å†µâ€æŒ‡çš„æ˜¯å›¾<span
class="math inline">\(A\)</span>ä¸å›¾<span
class="math inline">\(B\)</span>ä¸­çš„æ‰€æœ‰ç‰¹å¾éƒ½å¯ä»¥åœ¨å¯¹æ–¹çš„å›¾åƒä¸Šæ‰¾åˆ°å¯¹åº”å…³ç³»ã€‚ä½†æ˜¯å®é™…æƒ…å†µä¸‹ï¼Œå¯èƒ½å­˜åœ¨é®æŒ¡/è§†è§’å˜åŒ–/æ£€æµ‹å™ªå£°ç­‰å› ç´ çš„å¹²æ‰°ï¼Œå¤§æ¦‚ç‡ä¼šå‡ºç°å›¾<span
class="math inline">\(A\)</span>åœ¨å›¾<span
class="math inline">\(B\)</span>ä¸­æ‰¾ä¸åˆ°å¯¹åº”çš„åŒ¹é…ç‚¹ï¼Œåä¹‹äº¦ç„¶ã€‚</p>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue-ot-2.jpg" /></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¯¹äº<span
class="math inline">\(\mathbf{P}\)</span>çš„ç¬¬3åˆ—ï¼Œå³å›¾<span
class="math inline">\(B\)</span>çš„ç¬¬3å·ç‰¹å¾è€Œè¨€ï¼Œå®ƒå¹¶æ²¡æœ‰æ‰¾åˆ°äºå…¶å¯¹åº”çš„ç‰¹å¾åŒ¹é…ï¼Œæ‰€ä»¥å¯¹åº”çš„ç¬¬3åˆ—ä¹‹å’Œæ˜¯å°äº1çš„ï¼Œç¡®åˆ‡æ¥è¯´å¯¹äºä¸€ä¸ªè°ƒæ ¡çš„ç‰¹åˆ«å¥½çš„ç½‘ç»œè€Œè¨€ï¼Œç¬¬3åˆ—ä¹‹å’Œæ¥è¿‘äº0ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬åœ¨åšä¼˜åŒ–é—®é¢˜æ—¶å¹¶ä¸å–œæ¬¢ä¸ç­‰äºï¼Œæ‰€ä»¥ä½œè€…åç»­å¯¹å¾—åˆ†çŸ©é˜µä»¥åŠå¯¹åº”çš„åˆ†é…çŸ©é˜µè¿›è¡Œäº†å¢å¹¿ï¼Œè®©ä¸Šè¿°çº¦æŸå˜æˆäº†<span
class="math inline">\(=\)</span>ã€‚å…·ä½“åœ°ï¼Œæˆ‘ä»¬æ”¾åœ¨<a
href="#é®æŒ¡ä»¥åŠå¯è§æ€§">é®æŒ¡ä»¥åŠå¯è§æ€§</a>è¿›è¡Œè§£é‡Šã€‚</p>
<p>é‚£åç»­è®¾è®¡ç½‘ç»œçš„æœ€ç»ˆç›®æ ‡å°±æ˜¯è§£ç®—æ„å»ºä¸€ä¸ªä»£ä»·çŸ©é˜µå¹¶è¿™ä¸ªåˆ†é…çŸ©é˜µ<span
class="math inline">\(\mathbf{P}\)</span>ã€‚</p>
<h3 id="æ³¨æ„åŠ›gnn">æ³¨æ„åŠ›GNN</h3>
<p>è¿™é‡Œæœ‰ä¸ªæœ‰æ„æ€çš„è¯´æ³•ï¼šç‰¹å¾ç‚¹çš„ä½ç½®ä»¥åŠè§†è§‰å¤–è§‚èƒ½å¤Ÿæé«˜å…¶ç‰¹å¼‚æ€§ã€‚å¦å¤–ä¸€ä¸ªå…·æœ‰å¯å‘æ€§çš„è§‚ç‚¹æ˜¯äººç±»åœ¨å¯»æ‰¾åŒ¹é…ç‚¹è¿‡ç¨‹æ˜¯å…·æœ‰å‚è€ƒä»·å€¼çš„ã€‚æƒ³ä¸€ä¸‹äººç±»æ˜¯æ€æ ·è¿›è¡Œç‰¹å¾åŒ¹é…çš„ï¼Œäººç±»é€šè¿‡æ¥å›æµè§ˆä¸¤ä¸ªå›¾åƒè¯•æ¢æ€§ç­›é€‰åŒ¹é…å…³é”®ç‚¹ï¼Œå¹¶è¿›è¡Œæ¥å›æ£€æŸ¥ï¼ˆå¦‚æœä¸æ˜¯åŒ¹é…çš„ç‰¹å¾ï¼Œè§‚å¯Ÿä¸€ä¸‹å‘¨å›´æœ‰æ²¡æœ‰åŒ¹é…çš„æ›´å¥½çš„ç‚¹ï¼Œç›´åˆ°æ‰¾åˆ°åŒ¹é…ç‚¹/æˆ–æ²¡æœ‰åŒ¹é…ï¼‰ã€‚ä¸Šè¿°è¿‡ç¨‹äººä»¬é€šè¿‡ä¸»åŠ¨å¯»æ‰¾ä¸Šä¸‹æ–‡æ¥å¢åŠ ç‰¹å¾ç‚¹ç‰¹å¼‚æ€§ï¼Œè¿™æ ·å¯ä»¥æ’é™¤ä¸€äº›å…·æœ‰å¥‡å¼‚æ€§çš„åŒ¹é…ã€‚æœ¬æ–‡çš„æ ¸å¿ƒå°±æ˜¯åˆ©ç”¨åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„GNNå®ç°ä¸Šè¿°è¿‡ç¨‹ï¼Œå³æ¨¡æ‹Ÿäº†äººç±»è¿›è¡Œç‰¹å¾åŒ¹é…ã€‚</p>
<h4 id="ç‰¹å¾ç‚¹encode">ç‰¹å¾ç‚¹Encode</h4>
<p>é¦–å…ˆæ ¹æ®ä¸Šè¿°è¯´æ³•ï¼Œç‰¹å¾ç‚¹ä½ç½®+æè¿°ä¼šè·å¾—æ›´å¼ºçš„ç‰¹å¾åŒ¹é…ç‰¹å¼‚æ€§ï¼Œæ‰€ä»¥è¿™é‡Œå°†ç‰¹å¾ç‚¹çš„ä½ç½®ä»¥åŠæè¿°å­åˆå¹¶æˆæ¯ä¸ªç‰¹å¾ç‚¹<span
class="math inline">\(i\)</span>çš„åˆå§‹è¡¨ç¤º<span
class="math inline">\(^{(0)} \mathbf{x}_{i}\)</span>ï¼Œ <span
class="math display">\[
^{(0)} \mathbf{x}_{i}=\mathbf{d}_{i}+\mathbf{M L
P}_{\mathrm{enc}}\left(\mathbf{p}_{i}\right)
\]</span> å…¶ä¸­MLPè¡¨ç¤ºå¤šå±‚æ„ŸçŸ¥æœºï¼ˆMultilayer Perceptron
ï¼ŒMLPï¼‰æ­¤å¤„ç”¨äºå¯¹ä½ç»´ç‰¹å¾å‡ç»´ï¼Œä¸Šå¼å®é™…ä¸Šæ˜¯å°†è§†è§‰å¤–è§‚ä»¥åŠç‰¹å¾ç‚¹ä½ç½®è¿›è¡Œäº†è€¦åˆï¼Œæ­£å› å¦‚æ­¤ï¼Œè¿™ä½¿å¾—è¯¥Encodeå½¢å¼ä½¿å¾—åç»­çš„æ³¨æ„åŠ›æœºåˆ¶èƒ½å¤Ÿå……åˆ†è€ƒè™‘åˆ°ç‰¹å¾çš„å¤–è§‚ä»¥åŠä½ç½®ç›¸ä¼¼åº¦ã€‚</p>
<p>ç‰¹å¾ç‚¹ç¼–ç ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">KeypointEncoder</span>(nn.Module):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Joint encoding of visual appearance and location using MLPs&quot;&quot;&quot;</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; feature_dim: 256, layers: [32, 64, 128, 256]&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, feature_dim, layers</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.encoder = MLP([<span class="number">3</span>] + layers + [feature_dim]) <span class="comment"># MLP([3, 32, 64, 128, 256, 256])</span></span><br><span class="line">        nn.init.constant_(self.encoder[-<span class="number">1</span>].bias, <span class="number">0.0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, kpts, scores</span>):</span><br><span class="line">        inputs = [kpts.transpose(<span class="number">1</span>, <span class="number">2</span>), scores.unsqueeze(<span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">return</span> self.encoder(torch.cat(inputs, dim=<span class="number">1</span>))    <span class="comment"># DIM: 1x256xM</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MLP</span>(<span class="params">channels: <span class="built_in">list</span>, do_bn=<span class="literal">True</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Multi-layer perceptron &quot;&quot;&quot;</span></span><br><span class="line">    n = <span class="built_in">len</span>(channels)</span><br><span class="line">    layers = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        layers.append(</span><br><span class="line">            nn.Conv1d(channels[i - <span class="number">1</span>], channels[i], kernel_size=<span class="number">1</span>, bias=<span class="literal">True</span>))</span><br><span class="line">        <span class="keyword">if</span> i &lt; (n-<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> do_bn:</span><br><span class="line">                layers.append(nn.BatchNorm1d(channels[i]))</span><br><span class="line">            layers.append(nn.ReLU())</span><br><span class="line">    <span class="keyword">return</span> nn.Sequential(*layers)</span><br></pre></td></tr></table></figure>
å°†æè¿°å­ä¸ç¼–ç åçš„ç‰¹å¾ç‚¹ç›¸åŠ å¯ä»¥å¾—åˆ°åç»­å¤šå±‚GNNçš„è¾“å…¥çš„åˆå€¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Keypoint MLP encoder.</span></span><br><span class="line">desc0 = desc0 + self.kenc(kpts0, data[<span class="string">&#x27;scores0&#x27;</span>]) <span class="comment">#å›¾A</span></span><br><span class="line">desc1 = desc1 + self.kenc(kpts1, data[<span class="string">&#x27;scores1&#x27;</span>]) <span class="comment">#å›¾B</span></span><br></pre></td></tr></table></figure>
<h4 id="å¤šå±‚gnn">å¤šå±‚GNN</h4>
<p>è€ƒè™‘ä¸€ä¸ªå•ä¸€çš„å®Œå…¨å›¾ï¼Œå®ƒçš„èŠ‚ç‚¹æ˜¯å›¾åƒä¸­æ¯ä¸ªç‰¹å¾ç‚¹ï¼Œè¿™ä¸ªå›¾åŒ…æ‹¬ä¸¤ç§ä¸åŒçš„æ— å‘è¾¹ï¼šä¸€ç§æ˜¯â€œIntra-image
edgesâ€ï¼ˆself edgeï¼‰<span class="math inline">\(\mathcal{E}_{\text {self
}}\)</span>ï¼Œå®ƒè¿æ¥äº†æ¥è‡ªå›¾åƒå†…éƒ¨ç‰¹å¾ç‚¹ï¼›å¦å¤–ä¸€ç§æ˜¯â€œInter-image
edgesâ€ï¼ˆcross edgeï¼‰<span class="math inline">\(\mathcal{E}_{\text
{cross }}\)</span>ï¼Œå®ƒè¿æ¥æœ¬å›¾ç‰¹å¾ç‚¹<span
class="math inline">\(i\)</span>ä¸å¦å¤–ä¸€å¼ å›¾æ‰€æœ‰ç‰¹å¾ç‚¹ï¼ˆæ„æˆäº†è¯¥è¾¹ï¼‰ã€‚</p>
<p>ä»¤<span class="math inline">\(^{(\ell)}
\mathbf{x}_{i}^{A}\)</span>è¡¨ç¤ºä¸ºå›¾åƒ<span
class="math inline">\(A\)</span>ä¸Šç¬¬<span
class="math inline">\(i\)</span>ä¸ªå…ƒç´ åœ¨ç¬¬<span
class="math inline">\(\ell\)</span>å±‚çš„ä¸­é—´è¡¨è¾¾å½¢å¼ã€‚ä¿¡æ¯ï¼ˆmessageï¼‰<span
class="math inline">\(\mathbf{m}_{\mathcal{E} \rightarrow
i}\)</span>æ˜¯èšåˆäº†æ‰€æœ‰ç‰¹å¾ç‚¹<span class="math inline">\(\{j:(i, j) \in
\mathcal{E}\}\)</span>ä¹‹åç‚¹ç»“æœï¼ˆå®ƒçš„å…·ä½“å½¢å¼åé¢çš„Attentional
Aggregationä¼šä»‹ç»ï¼Œä¸€å¥è¯æ¥è¯´å°±æ˜¯å°†è‡ªæˆ‘æ³¨æ„åŠ›ä»¥åŠäº¤å‰æ³¨æ„åŠ›è¿›è¡Œèšåˆï¼‰ï¼Œå…¶ä¸­<span
class="math inline">\(\mathcal{E} \in \{\mathcal{E}_{\text {self
}},\mathcal{E}_{\text {self }}\}\)</span>ï¼Œæ‰€ä»¥å›¾åƒ<span
class="math inline">\(A\)</span>ä¸­æ‰€æœ‰ç‰¹å¾<span
class="math inline">\(i\)</span>ä¼ é€’æ›´æ–°çš„æ®‹å·®ä¿¡æ¯ï¼ˆresidual
messageï¼Ÿï¼‰æ˜¯ï¼š <span class="math display">\[
^{(\ell+1)} \mathbf{x}_{i}^{A}=^{(\ell)}
\mathbf{x}_{i}^{A}+\operatorname{MLP}\left(\left[^{(\ell)}
\mathbf{x}_{i}^{A} \| \mathbf{m}_{\mathcal{E} \rightarrow
i}\right]\right)
\]</span> å…¶ä¸­<span class="math inline">\([\cdot \|
\cdot]\)</span>è¡¨ç¤ºä¸²è”æ“ä½œã€‚åŒæ ·çš„ï¼Œå›¾åƒ<span
class="math inline">\(B\)</span>ä¸Šæ‰€æœ‰ç‰¹å¾æœ‰ç±»ä¼¼çš„æ›´æ–°å½¢å¼ã€‚å¯ä»¥çœ‹åˆ°self
ä»¥åŠcross
edgesç»‘åœ¨ä¸€èµ·å¹¶äº¤æ›¿è¿›è¡Œæ›´æ–°ï¼Œå…ˆselfåcrossï¼Œä½œè€…æåˆ°å…±æœ‰å›ºå®šæ•°é‡çš„<span
class="math inline">\(L\)</span>å±‚ã€‚</p>
<p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™é‡Œçš„self-/cross-attentionå®é™…ä¸Šå°±æ˜¯æ¨¡æ‹Ÿäº†äººç±»æ¥å›æµè§ˆåŒ¹é…çš„è¿‡ç¨‹ï¼Œå…¶ä¸­self-attentionæ˜¯ä¸ºäº†ä½¿å¾—ç‰¹å¾æ›´åŠ å…·æœ‰åŒ¹é…ç‰¹å¼‚æ€§ï¼Œè€Œcross-attentionæ˜¯ä¸ºäº†ç”¨è¿™äº›å…·æœ‰ç‰¹å¼‚æ€§çš„ç‚¹åšå›¾åƒé—´ç‰¹å¾çš„ç›¸ä¼¼åº¦æ¯”è¾ƒã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AttentionalGNN</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, feature_dim: <span class="built_in">int</span>, layer_names: <span class="built_in">list</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.layers = nn.ModuleList([</span><br><span class="line">            AttentionalPropagation(feature_dim, <span class="number">4</span>)</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(layer_names))])</span><br><span class="line">        self.names = layer_names</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, desc0, desc1</span>):</span><br><span class="line">        <span class="keyword">for</span> layer, name <span class="keyword">in</span> <span class="built_in">zip</span>(self.layers, self.names):</span><br><span class="line">            layer.attn.prob = []</span><br><span class="line">            <span class="keyword">if</span> name == <span class="string">&#x27;cross&#x27;</span>:</span><br><span class="line">                src0, src1 = desc1, desc0</span><br><span class="line">            <span class="keyword">else</span>:  <span class="comment"># if name == &#x27;self&#x27;:</span></span><br><span class="line">                src0, src1 = desc0, desc1</span><br><span class="line">            delta0, delta1 = layer(desc0, src0), layer(desc1, src1)</span><br><span class="line">            desc0, desc1 = (desc0 + delta0), (desc1 + delta1)</span><br><span class="line">        <span class="keyword">return</span> desc0, desc1</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AttentionalPropagation</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, feature_dim: <span class="built_in">int</span>, num_heads: <span class="built_in">int</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.attn = MultiHeadedAttention(num_heads, feature_dim)</span><br><span class="line">        self.mlp = MLP([feature_dim*<span class="number">2</span>, feature_dim*<span class="number">2</span>, feature_dim]) <span class="comment">#å…¶ä¸­MLPéšå«å±‚é…ç½®[512,512,256] </span></span><br><span class="line">        nn.init.constant_(self.mlp[-<span class="number">1</span>].bias, <span class="number">0.0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x, source</span>):</span><br><span class="line">        message = self.attn(x, source, source)           <span class="comment"># q,k,v, DIM: 1x256xM</span></span><br><span class="line">        <span class="keyword">return</span> self.mlp(torch.cat([x, message], dim=<span class="number">1</span>))  <span class="comment">#DIM: 1x256xM</span></span><br></pre></td></tr></table></figure></p>
<h4 id="attentional-aggregation">Attentional Aggregation</h4>
<p>è¿™ä¸€å°èŠ‚ä»‹ç»ä¸Šè¿°ä»‹ç»ç§çš„messageæ˜¯å¦‚ä½•è·å¾—çš„ã€‚</p>
<p>æ–‡ç« çš„äº®ç‚¹ä¹‹ä¸€å°±æ˜¯å°†æ³¨æ„åŠ›æœºåˆ¶ç”¨äºç‰¹å¾åŒ¹é…ï¼Œè¿™åˆ°åº•æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿä½œè€…æåˆ°ï¼Œæ³¨æ„åŠ›æœºåˆ¶å°†selfä»¥åŠcrossä¿¡æ¯èšåˆå¾—åˆ°<span
class="math inline">\(\mathbf{m}_{\mathcal{E} \rightarrow
i}\)</span>ã€‚å…¶ä¸­self edgeåˆ©ç”¨äº†self-attention[58]ï¼Œcross
edgeåˆ©ç”¨äº†cross-attentionã€‚ç±»ä¼¼äºæ•°æ®åº“æ£€ç´¢ï¼Œæˆ‘ä»¬æƒ³è¦æŸ¥è¯¢<span
class="math inline">\(\mathbf{q}_i\)</span>åŸºäºå…ƒç´ çš„å±æ€§å³é”®<span
class="math inline">\(\mathbf{k}_i\)</span>ï¼Œæ£€ç´¢åˆ°äº†æŸäº›å…ƒç´ çš„å€¼<span
class="math inline">\(\mathbf{v}_j\)</span>ã€‚ <span
class="math display">\[
\mathbf{m}_{\mathcal{E} \rightarrow i}=\sum_{j:(i, j) \in \mathcal{E}}
\alpha_{i j} \mathbf{v}_{j}
\]</span> å…¶ä¸­æ³¨æ„åŠ›æƒé‡<span
class="math inline">\({\alpha}_{ij}\)</span>æ˜¯æŸ¥è¯¢ä¸æ£€ç´¢åˆ°å¯¹è±¡é”®å€¼ç›¸ä¼¼åº¦çš„<span
class="math inline">\(\operatorname{Softmax}\)</span>å³ï¼Œ<span
class="math inline">\(\alpha_{i
j}=\operatorname{Softmax}_{j}\left(\mathbf{q}_{i}^{\top}
\mathbf{k}_{j}\right)\)</span>ã€‚</p>
<p>è¿™é‡Œéœ€è¦è§£é‡Šä¸€ä¸‹é”®ï¼ˆkeyï¼‰ï¼Œqueryä»¥åŠå€¼ï¼ˆvalueï¼‰ã€‚ä»¤å¾…æŸ¥è¯¢ç‚¹ç‰¹å¾ç‚¹<span
class="math inline">\(i\)</span>ä½äºæŸ¥è¯¢å›¾åƒ<span
class="math inline">\(Q\)</span>ä¸Šï¼Œæ‰€æœ‰çš„æºç‰¹å¾ç‚¹ä½äºå›¾åƒ<span
class="math inline">\(S\)</span>ä¸Šï¼Œå…¶ä¸­<span class="math inline">\((Q,
S) \in\{A,
B\}^{2}\)</span>ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å°†keyï¼Œqueryä»¥åŠvalueå†™æˆä¸‹è¿°å½¢å¼ï¼š <span
class="math display">\[
\begin{aligned} \mathbf{q}_{i} &amp;=\mathbf{W}_{1}^{(\ell)}
\mathbf{x}_{i}^{Q}+\mathbf{b}_{1} \\\left[\begin{array}{l}\mathbf{k}_{j}
\\ \mathbf{v}_{j}\end{array}\right]
&amp;=\left[\begin{array}{l}\mathbf{W}_{2} \\
\mathbf{W}_{3}\end{array}\right](\ell)
\mathbf{x}_{i}^{S}+\left[\begin{array}{l}\mathbf{b}_{2} \\
\mathbf{b}_{3}\end{array}\right] \end{aligned}
\]</span> æ¯ä¸€å±‚<span
class="math inline">\(\ell\)</span>éƒ½æœ‰å…¶å¯¹åº”çš„ä¸€å¥—æŠ•å½±å‚æ•°ï¼Œè¿™äº›å‚æ•°è¢«æ‰€æœ‰çš„ç‰¹å¾ç‚¹å…±äº«ã€‚ç†è§£ä¸€ä¸‹ï¼šæ­¤å¤„çš„<span
class="math inline">\(\mathbf{q}_i\)</span>å¯¹åº”äºå¾…æŸ¥è¯¢å›¾åƒä¸ŠæŸä¸ªç‰¹å¾ç‚¹<span
class="math inline">\(i\)</span>çš„ä¸€ç§è¡¨ç¤ºï¼ˆself-attentionæ˜ å°„ï¼‰ï¼Œ<span
class="math inline">\(\mathbf{k}_j\)</span>ä»¥åŠ<span
class="math inline">\(\mathbf{v}_j\)</span>éƒ½æ˜¯æ¥è‡ªäºå¬å›çš„å›¾åƒç‰¹å¾ç‚¹<span
class="math inline">\(j\)</span>çš„ä¸€ç§è¡¨ç¤ºï¼ˆæ˜ å°„ï¼‰ï¼›<span
class="math inline">\(\alpha_{i
j}\)</span>è¡¨ç¤ºè¿™ä¸¤ä¸ªç‰¹å¾ç›¸ä¼¼åº¦ï¼Œå®ƒæ˜¯ç”±<span
class="math inline">\(\mathbf{q}_i\)</span>ä»¥åŠ<span
class="math inline">\(\mathbf{k}_j\)</span>è®¡ç®—å¾—åˆ°ï¼ˆåœ¨è¿™é‡Œä½“ç°äº†cross-attentionçš„æ€æƒ³ï¼Ÿï¼‰ï¼Œè¶Šå¤§å°±è¡¨ç¤ºè¿™ä¸¤ä¸ªç‰¹å¾è¶Šç›¸ä¼¼ï¼Œç„¶ååˆ©ç”¨è¯¥ç›¸ä¼¼åº¦å¯¹<span
class="math inline">\(\mathbf{v}_j\)</span>åŠ æƒæ±‚å’Œå¾—åˆ°<span
class="math inline">\(\mathbf{m}_{\mathcal{E} \rightarrow
i}\)</span>ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„<strong>ç‰¹å¾èšåˆ</strong>ã€‚</p>
<p>ä¸Šé¢æåˆ°çš„è¿™äº›æ¦‚å¿µæœ‰äº›éš¾ä»¥ç†è§£ï¼Œä½œè€…ç‰¹æ„å¯¹ä¸Šè¿°è¿‡ç¨‹è¿›è¡Œäº†å¯è§†åŒ–ï¼Œself-attentionå°±æ˜¯ä¸€å¼ å›¾åƒå†…éƒ¨çš„è¾¹ç›¸è¿è¿›è¡Œèšåˆï¼Œå®ƒèƒ½å¤Ÿæ›´åŠ å…³æ³¨å…·æœ‰ç‰¹å¼‚æ€§çš„æ‰€æœ‰ç‚¹ï¼Œä¸”å¹¶ä¸ä»…å±€é™äºå…¶é‚»åŸŸä½ç½®ç‰¹å¾ï¼ˆå¿ƒå¿ƒç›¸ä¾ï¼Œä½•æƒ§åƒé‡Œï¼Œé€ƒ...ï¼‰ï¼›cross-attentionåšçš„å°±æ˜¯åŒ¹é…é‚£äº›å¤–è§‚ç›¸ä¼¼çš„ä¸¤å¼ å›¾åƒè§çš„ç‰¹å¾ã€‚</p>
<figure>
<img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_fig_4.png"
alt="superglue_fig_4" />
<figcaption aria-hidden="true">superglue_fig_4</figcaption>
</figure>
<figure>
<img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_fig_7.jpg"
alt="superglue_fig_7" />
<figcaption aria-hidden="true">superglue_fig_7</figcaption>
</figure>
<p>ä¸‹å›¾å±•ç¤ºäº†æ¯å±‚self-attentionä»¥åŠacross-attentionä¸­æƒé‡<span
class="math inline">\({\alpha_{i
j}}\)</span>çš„ç»“æœã€‚æŒ‰ç…§åŒ¹é…ä»éš¾åˆ°æ˜“ï¼Œæ–‡ä¸­ç”»å‡ºäº†3ä¸ªä¸åŒçš„ç‰¹å¾ç‚¹ä½œä¸ºæ¼”ç¤ºï¼Œç»¿è‰²ç‰¹å¾ç‚¹ï¼ˆå®¹æ˜“ï¼‰ï¼Œè“è‰²ç‰¹å¾ç‚¹ï¼ˆä¸­ç­‰ï¼‰ä»¥åŠçº¢è‰²ç‰¹å¾ç‚¹ï¼ˆå›°éš¾ï¼‰ã€‚å¯¹äºself-attentionï¼Œåˆå§‹æ—¶å®ƒï¼ˆæŸä¸ªç‰¹å¾ï¼‰å…³è”äº†å›¾åƒä¸Šæ‰€æœ‰çš„ç‚¹ï¼ˆé¦–è¡Œï¼‰ï¼Œç„¶åé€æ¸åœ°å…³æ³¨åœ¨ä¸è¯¥ç‰¹å¾ç›¸é‚»è¿‘çš„ç‰¹å¾ç‚¹ï¼ˆå°¾è¡Œï¼‰ã€‚åŒæ ·åœ°ï¼Œcross-attentionä¸»è¦å…³æ³¨å»åŒ¹é…å¯èƒ½çš„ç‰¹å¾ç‚¹ï¼Œéšç€å±‚çš„å¢åŠ ï¼Œå®ƒé€æ¸å‡å°‘åŒ¹é…ç‚¹é›†ç›´åˆ°æ”¶æ•›ã€‚ç»¿è‰²ç‰¹å¾ç‚¹åœ¨ç¬¬9å±‚å°±å·²ç»è¶‹è¿‘æ”¶æ•›ï¼Œè€Œçº¢è‰²ç‰¹å¾ç›´åˆ°æœ€åæ‰èƒ½è¶‹ç´§æ”¶æ•›ï¼ˆåŒ¹é…ï¼‰ã€‚å¯ä»¥çœ‹åˆ°æ— è®ºæ˜¯selfè¿˜æ˜¯crossï¼Œå®ƒä»¬å…³æ³¨çš„åŒºåŸŸéƒ½ä¼šéšç€ç½‘ç»œå±‚æ·±åº¦çš„å¢åŠ è€Œé€æ¸ç¼©å°ã€‚</p>
<figure>
<img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_fig_15_1.jpg"
alt="superglue_fig_15" />
<figcaption aria-hidden="true">superglue_fig_15</figcaption>
</figure>
<p>ç»è¿‡äº†<span
class="math inline">\(L\)</span>æ¬¡self/cross-attentionåå°±å¯ä»¥å¾—åˆ°æ³¨æ„åŠ›GNNçš„è¾“å‡ºï¼Œå¯¹äºå›¾åƒ<span
class="math inline">\(A\)</span>æˆ‘ä»¬æœ‰ï¼š <span class="math display">\[
\mathbf{f}_{i}^{A}=\mathbf{W} \cdot^{(L)} \mathbf{x}_{i}^{A}+\mathbf{b},
\quad \forall i \in \mathcal{A}
\]</span> æˆ‘ä»¬å¯ä»¥æŠŠ<span
class="math inline">\(\mathbf{f}_{i}^{A}\)</span>ç†è§£ä¸º<strong>åŒ¹é…æè¿°å­</strong>ï¼ˆç±»æ¯”ç‰¹å¾æè¿°å­ï¼‰ï¼Œä¸“é—¨ä¸ºç‰¹å¾åŒ¹é…æœåŠ¡ï¼Œå¯¹äºå›¾åƒ<span
class="math inline">\(B\)</span>å…·æœ‰ç±»ä¼¼çš„å½¢å¼ã€‚</p>
<h3 id="åŒ¹é…å±‚optimal-matching-layer">åŒ¹é…å±‚ï¼ˆOptimal matching
layerï¼‰</h3>
<p>æ¥ä¸‹æ¥çš„ä»»åŠ¡å°±æ˜¯å»æ„å»ºè½¯åˆ†é…çŸ©é˜µ<span
class="math inline">\(\mathbf{P}\)</span>ã€‚å¯¹äºä¸€èˆ¬çš„å›¾åŒ¹é…æµç¨‹ï¼Œè¿™ä¸ªåˆ†é…çŸ©é˜µå¯ä»¥é€šè¿‡è®¡ç®—ä¸€ä¸ªå¾—åˆ†çŸ©é˜µ<span
class="math inline">\(\mathbf{S} \in \mathbb{R}^{M \times
N}\)</span>ï¼ˆç”¨æ¥è¡¨ç¤ºä¸€äº›æ½œåœ¨çš„åŒ¹é…ï¼‰æ¥å®ç°ã€‚å…·ä½“è€Œè¨€ï¼Œé€šè¿‡æœ€å¤§åŒ–æ€»ä½“å¾—åˆ†<span
class="math inline">\(\sum_{i, j} \mathbf{S}_{i, j} \mathbf{P}_{i,
j}\)</span>å³å¯å¾—åˆ°è¿™ä¸ªåˆ†é…çŸ©é˜µ<span
class="math inline">\(\mathbf{P}\)</span>ï¼Œå…¶ä¸­è¦æ³¨æ„çš„æ˜¯<span
class="math inline">\(\mathbf{P}\)</span>æ˜¯æœ‰çº¦æŸçš„ã€‚</p>
<h4 id="åŒ¹é…å¾—åˆ†é¢„æµ‹">åŒ¹é…å¾—åˆ†é¢„æµ‹</h4>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue-ot-sh-score.jpg" /></p>
<p>ä½œè€…ä½¿ç”¨GNNèšåˆå¾—åˆ°çš„<span
class="math inline">\(\mathbf{f}_{i}^{A}\)</span>ä»¥åŠ<span
class="math inline">\(\mathbf{f}_{i}^{B}\)</span>è®¡ç®—å†…ç§¯å¾—åˆ°å¾—åˆ†ï¼š
<span class="math display">\[
\mathbf{S}_{i, j}=&lt;\mathbf{f}_{i}^{A}, \mathbf{f}_{j}^{B}&gt;,
\forall(i, j) \in \mathcal{A} \times \mathcal{B}
\]</span></p>
<h4 id="é®æŒ¡ä»¥åŠå¯è§æ€§">é®æŒ¡ä»¥åŠå¯è§æ€§</h4>
<p>ç±»ä¼¼äºSuperPointåœ¨æå–ç‰¹å¾ç‚¹æ—¶å¢åŠ äº†ä¸€å±‚dustbiné€šé“ï¼Œä¸“é—¨ä¸ºäº†åº”å¯¹å›¾åƒä¸­æ²¡æœ‰ç‰¹å¾ç‚¹æƒ…å†µã€‚æœ¬æ–‡å€Ÿé‰´äº†è¯¥æ€æƒ³ï¼Œåœ¨å¾—åˆ†çŸ©é˜µ<span
class="math inline">\(\mathbf{S}\)</span>çš„æœ€åä¸€åˆ—/è¡Œè®¾ç½®ä¸ºdustbinså¯ä»¥å¾—åˆ°<span
class="math inline">\(\overline{\mathbf{S}}\)</span>ï¼Œè¿™æ ·åšçš„ä½œç”¨åœ¨äºå¯ä»¥æ»¤å‡ºé”™è¯¯çš„åŒ¹é…ç‚¹ã€‚
<span class="math display">\[
\overline{\mathbf{S}}_{i, N+1}=\overline{\mathbf{S}}_{M+1,
j}=\overline{\mathbf{S}}_{M+1, N+1}=z \in \mathbb{R}
\]</span> å›¾åƒ<span
class="math inline">\(A\)</span>ä¸Šçš„ç‰¹å¾ç‚¹è¢«åˆ†é…åˆ°å›¾åƒ<span
class="math inline">\(B\)</span>ä¸ŠæŸä¸ªç‰¹å¾åŒ¹é…æˆ–è€…è¢«åˆ†é…åˆ°dustbinï¼Œè¿™å°±æ„å‘³ç€æ¯ä¸ªdustbinæœ‰<span
class="math inline">\(N,M\)</span>ä¸ªåŒ¹é…ï¼Œå› æ­¤è½¯åˆ†é…çŸ©é˜µæœ‰å¦‚ä¸‹çº¦æŸï¼š
<span class="math display">\[
\overline{\mathbf{P}} \mathbf{1}_{N+1}=\mathbf{a} \quad\text {  and }
\quad \overline{\mathbf{P}}^{\top} \mathbf{1}_{M+1}=\mathbf{b}
\]</span> å…¶ä¸­<span
class="math inline">\(\mathbf{a}=\left[\begin{array}{ll}\mathbf{1}_{M}^{\top}
&amp; N\end{array}\right]^{\top}\)</span>ï¼Œ<span
class="math inline">\(\mathbf{b}=\left[\begin{array}{ll}\mathbf{1}_{N}^{\top}
&amp; M\end{array}\right]^{\top}\)</span>ã€‚<span
class="math inline">\(\mathbf{a}\)</span> <strong>è¡¨ç¤ºå›¾<span
class="math inline">\(A\)</span>ä¸­ç‰¹å¾ç‚¹ä»¥åŠdustbinçš„æœŸæœ›åŒ¹é…æ•°</strong>ï¼Œå³æ­£å¸¸æƒ…å†µä¸‹ï¼Œå›¾<span
class="math inline">\(A\)</span>ä¸­æ¯ä¸ªç‰¹å¾ç‚¹åœ¨å›¾<span
class="math inline">\(B\)</span>ä¸­ä»…ä¸”ä»…æœ‰1ä¸ªåŒ¹é…ç‚¹ï¼Œä½†æ˜¯å¯¹äºå›¾<span
class="math inline">\(A\)</span>çš„dustbinè€Œè¨€ï¼Œå®ƒå¯èƒ½åŒ¹é…åˆ°å›¾Bçš„ä»»ä½•ä¸€ä¸ªç‰¹å¾ç‚¹ï¼Œå³æœ‰<span
class="math inline">\(N\)</span>ç§å¯èƒ½æ€§ï¼Œæ‰€ä»¥<span
class="math inline">\(\mathbf{a} =
\left[\begin{array}{ll}\mathbf{1}_{M}^{\top} &amp;
N\end{array}\right]^{\top}\)</span>ã€‚</p>
<p>ä½œè€…Sarlinåœ¨è¿™ä¸ª<a
target="_blank" rel="noopener" href="https://github.com/magicleap/SuperGluePretrainedNetwork/issues/36">é—®é¢˜</a>ä¸­æåˆ°ï¼Œä¸Šå¼çš„çº¦æŸé¡¹ä¹‹æ‰€ä»¥è¢«æ›¿æ¢æˆ<span
class="math inline">\(=\)</span>ï¼Œæ˜¯å› ä¸ºåšäº†ç±»ä¼¼äº<code>æ¾å¼›åŒ–</code>çš„æ“ä½œï¼Œè¿™ä¹ˆåšçš„å¥½å¤„æ˜¯å°†åŸæœ¬éš¾ä»¥ä¼˜åŒ–çš„ä¸ç­‰é—®é¢˜å˜ä¸ºæ’ç­‰çº¦æŸï¼ˆåŸè¯ä¸º"These
are like slack variables that enforce the equality
constraint"ï¼‰ï¼ŒåŒæ—¶å¯ä»¥æ¯”è¾ƒå¥½çš„åº”å¯¹æ²¡æœ‰åŒ¹é…çš„ç‰¹å¾æˆ–è€…é”™è¯¯çš„ç‰¹å¾ï¼ˆè¿™å…¶å®æ˜¯<strong>å¢åŠ dustbiné€šé“çš„åŸå› ï¼Œå®ƒèµ·åˆ°æ»¤é™¤å¤–ç‚¹çš„ä½œç”¨</strong>ï¼‰ã€‚</p>
<p><del>ï¼ˆ<font color="red">æ­¤å¤„ä¸å¤ªç†è§£ï¼Œæœ€åä¸€ç»´ä¸ºä½•ä¸ºNï¼Ÿ</font>æ­¤å¤„å¯å‚è€ƒ<a
target="_blank" rel="noopener" href="https://blog.csdn.net/shizhuoduao/article/details/107120805">è¿™ç¯‡æ–‡ç« </a>çš„è§£é‡Šã€‚ï¼‰</del></p>
<h4 id="sinkhorn-algorithm">Sinkhorn Algorithm</h4>
<p>æ±‚è§£æœ€å¤§åŒ–æ€»ä½“å¾—åˆ†å¯ç”±â€œSinkhorn Algorithmâ€[52,12]è¿›è¡Œæ±‚è§£ã€‚</p>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue-ot-sh-1.png" /></p>
<p>æ­¤å¤„æœ‰å¿…è¦å¯¹optimal tranporté—®é¢˜åšä¸€ä¸‹è§£é‡Šï¼Œæœ‰å…³optimal
tranporté—®é¢˜çš„ä»‹ç»å¯å‚è€ƒè¿™ç¯‡æ–‡ç« <a
target="_blank" rel="noopener" href="https://michielstock.github.io/posts/2017/2017-11-5-OptimalTransport/">Notes
on Optimal
Transport</a>ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè“è‰²èƒŒæ™¯åŒºåŸŸçš„å‡ ä¸ªå…¬å¼ç»™å‡ºäº†é’ˆå¯¹è¯¥ç‰¹å¾åŒ¹é…é—®é¢˜çš„â€œä»£ä»·å‡½æ•°â€ï¼Œå‡†ç¡®æ¥è¯´åº”è¯¥æ˜¯<strong>è´Ÿçš„ä»£ä»·å‡½æ•°</strong>ã€‚å› ä¸ºåŸå§‹çš„æœ€ä¼˜ä¼ è¾“é—®é¢˜ä¸­<span
class="math inline">\(\bar{S}\)</span>æ‰®æ¼”çš„è§’è‰²åº”è¯¥æ˜¯<code>cost matrix</code>ï¼Œå³ä»£ä»·çŸ©é˜µï¼›å¯¹æ¯”ä¹‹ä¸‹ï¼Œæœ¬ä¾‹ä¸­<span
class="math inline">\(\bar{S}\)</span>ä¸ºåŒ¹é…æè¿°å­çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œè¿™æ­£å¥½ä¸ä»£ä»·çŸ©é˜µç›¸åã€‚æ­£å› å¦‚æ­¤ï¼Œç›¸è¾ƒäºåŸå§‹æœ€ä¼˜ä¼ è¾“é—®é¢˜çš„æœ€å°åŒ–ä»£ä»·å‡½æ•°ï¼Œæœ¬ä¾‹çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–åŒ¹é…æè¿°å­çš„ç›¸ä¼¼åº¦ï¼Œæ‰€ä»¥ä¸Šå¼ä¸º<span
class="math inline">\(\max\)</span>è€Œé<span
class="math inline">\(\min\)</span>ã€‚</p>
<p>è‡³äºå¦‚ä½•æ±‚è§£æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼Œ<code>sinkhorn algorithm</code>ç®—æ³•èƒ½å¤Ÿä»¥ä¸€ç§è¿­ä»£çš„æ–¹å¼å¯¹è¯¥é—®é¢˜è¿›è¡Œæ±‚è§£ï¼Œå…·ä½“çš„æ–¹æ³•æ˜¯ï¼š
&gt; ç»™å®šï¼šåŒ¹é…æè¿°å­çš„ä½™å¼¦ç›¸ä¼¼åº¦çŸ©é˜µ<span
class="math inline">\(\bar{S}\)</span>ï¼Œä¸¤ä¸ªåˆ†å¸ƒ<span
class="math inline">\(\mathbf{a}\)</span>å’Œ<span
class="math inline">\(\mathbf{b}\)</span>ï¼Œæ­£åˆ™é¡¹<span
class="math inline">\(\lambda\)</span>ï¼ˆè¶Šå¤§è¡¨ç¤ºåˆ†é…è¶Šå‡åŒ€ï¼Œé»˜è®¤ä¸º1ï¼‰
åˆå§‹åŒ–ï¼šåˆ†é…çŸ©é˜µï¼š<span class="math inline">\(\mathbf{\bar{P}} =
\exp^{-\lambda \mathbf{\bar{S}}}\)</span> é‡å¤ï¼š
1.ç¼©æ”¾è¡Œï¼Œä½¿å¾—è¡Œä¹‹å’Œä¸º<span class="math inline">\(\mathbf{a}\)</span>.
2.ç¼©æ”¾åˆ—ï¼Œä½¿å¾—åˆ—ä¹‹å’Œä¸º<span class="math inline">\(\mathbf{b}\)</span>.
ç›´è‡³æ”¶æ•›.</p>
<p>æ¥ä¸‹æ¥ï¼Œç¬”è€…ç»™å‡ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä¸€æ­¥æ­¥é˜è¿°<code>sinkhorn algorithm</code>æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚</p>
<p>é¦–å…ˆç»™å®šè¾“å…¥ï¼Œå¹¶åˆå§‹åŒ–åˆ†é…çŸ©é˜µï¼ˆæ³¨ï¼Œä¸ºæ–¹ä¾¿èµ·è§ï¼Œåˆ†é…çŸ©é˜µè¢«åˆå§‹åŒ–ä¸ºä»£ä»·çŸ©é˜µ<span
class="math inline">\(\mathbf{\bar{P}}
=\mathbf{\bar{S}}\)</span>ï¼Œå®é™…æƒ…å†µä¸‹æ˜¯<span
class="math inline">\(\mathbf{\bar{P}} = \exp^{-\lambda
\mathbf{\bar{S}}}\)</span>ï¼‰ <img data-src="https://vincentqin.tech/blog-resources/superglue/superglue-ot-sh-2.png" /></p>
<p>æ­¥éª¤1ï¼šè®¡ç®—ç›®å‰çš„è¡Œä¹‹å’Œï¼›
æ­¥éª¤2ï¼šå¯¹äºPçŸ©é˜µçš„æ¯ä¸€è¡Œï¼Œåˆ†åˆ«é™¤ä»¥ä¸Šè¿°è¡Œä¹‹å’Œå¹¶ä¹˜ç›®æ ‡è¡Œä¹‹å’Œaï¼›</p>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue-ot-sh-3.png" /></p>
<p>æ­¥éª¤3ï¼šè®¡ç®—ç›®å‰çš„åˆ—ä¹‹å’Œï¼›
æ­¥éª¤4ï¼šå¯¹äºPçŸ©é˜µçš„æ¯ä¸€åˆ—ï¼Œåˆ†åˆ«é™¤ä»¥ä¸Šè¿°åˆ—ä¹‹å’Œå¹¶ä¹˜ç›®æ ‡åˆ—ä¹‹å’Œbï¼›</p>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue-ot-sh-4.png" /></p>
<p>å¯¹è¡Œåˆ—é‡å¤æ‰§è¡Œ1-4æ­¥ï¼Œç»è¿‡4æ¬¡è¿­ä»£ååˆ†é…çŸ©é˜µçš„è¡Œä¹‹å’Œå°±ä¸<span
class="math inline">\(\mathbf{a}\)</span>ä¸€è‡´ï¼Œåˆ—ä¹‹å’Œä¸<span
class="math inline">\(\mathbf{b}\)</span>ä¸€è‡´ã€‚ <img data-src="https://vincentqin.tech/blog-resources/superglue/superglue-ot-sh-5.png" /></p>
<p>ä¸‹é¢ç¬”è€…ä½¿ç”¨matlabé‡å†™äº†ä¸€ä¸ª<code>sinkhorn algorithm</code>çš„demoï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è¿è¡Œä¸€ä¸‹ï¼Œç„¶åcheckä¸‹æœ€åçš„åˆ†é…çŸ©é˜µPçš„è¡Œä¹‹å’Œæ˜¯å¦ä¸º1/åˆ—ä¹‹å’Œæ˜¯å¦ä¸º1ã€‚</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">clear all;</span><br><span class="line">close all;</span><br><span class="line">clc;</span><br><span class="line"></span><br><span class="line">lam = <span class="number">1</span>;</span><br><span class="line">epslion = <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">% S_  = rand(3,4);</span></span><br><span class="line"></span><br><span class="line">S  = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>;</span><br><span class="line">         <span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>;</span><br><span class="line">         <span class="number">2</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">[m,n] = <span class="built_in">size</span>(S);</span><br><span class="line"></span><br><span class="line">a  = <span class="built_in">ones</span>(m,<span class="number">1</span>);</span><br><span class="line">b  = <span class="built_in">ones</span>(<span class="number">1</span>,n);</span><br><span class="line"></span><br><span class="line">[P_bar, error] = SinkhornAlgorithm(S,a,b,lam,epslion);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">axis equal</span><br><span class="line">imagesc(P_bar)</span><br><span class="line">set(gcf,<span class="string">&#x27;color&#x27;</span>,[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]);</span><br><span class="line">box off;</span><br><span class="line">axis off</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[P_bar, error]</span> = <span class="title">SinkhornAlgorithm</span><span class="params">(S,a,b,lam,epslion)</span></span></span><br><span class="line">    </span><br><span class="line"><span class="comment">%     Computes the optimal transport matrix and Slinkhorn distance using the</span></span><br><span class="line"><span class="comment">%     Sinkhorn-Knopp algorithm</span></span><br><span class="line"><span class="comment">% </span></span><br><span class="line"><span class="comment">%     Inputs:</span></span><br><span class="line"><span class="comment">%         - S : cost matrix (mxn)</span></span><br><span class="line"><span class="comment">%         - a: vector of marginals (m, )</span></span><br><span class="line"><span class="comment">%         - b : vector of marginals (n, )</span></span><br><span class="line"><span class="comment">%         - lam : strength of the entropic regularization</span></span><br><span class="line"><span class="comment">%         - epslion : convergence parameter</span></span><br><span class="line"><span class="comment">% </span></span><br><span class="line"><span class="comment">%     Outputs:</span></span><br><span class="line"><span class="comment">%         - P : optimal transport matrix (mxn)</span></span><br><span class="line"><span class="comment">%         - dist : Sinkhorn distance</span></span><br><span class="line"><span class="comment">%     Author: realcat </span></span><br><span class="line"><span class="comment">%     Date:    2022.04.03</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">% add dustbin channel</span></span><br><span class="line">  dust= <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">  [m,n] = <span class="built_in">size</span>(S);</span><br><span class="line"></span><br><span class="line">  S_bar = [S,dust * <span class="built_in">ones</span>(m,<span class="number">1</span>);</span><br><span class="line">          dust *<span class="built_in">ones</span>(<span class="number">1</span>,n+<span class="number">1</span>)];</span><br><span class="line">    </span><br><span class="line">  a  = [a;n];</span><br><span class="line">  b  = [b,m];</span><br><span class="line"></span><br><span class="line">  <span class="comment">%% OT BEGIN</span></span><br><span class="line"></span><br><span class="line">  [m,n] = <span class="built_in">size</span>(S_bar);</span><br><span class="line">  P_bar = <span class="built_in">exp</span>(-lam * S_bar);</span><br><span class="line">  P_bar = P_bar / sum(P_bar(:));</span><br><span class="line"></span><br><span class="line">  max_iters = <span class="number">100</span>;</span><br><span class="line">  counter   = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> <span class="number">1</span></span><br><span class="line">    u     = sum(P_bar,<span class="number">2</span>);                 <span class="comment">% sum of rows</span></span><br><span class="line">    P_bar = P_bar .* <span class="built_in">repmat</span>(a./ u,[<span class="number">1</span>,n]); <span class="comment">% scale rows</span></span><br><span class="line">    v     = sum(P_bar,<span class="number">1</span>);                 <span class="comment">% sum of cols</span></span><br><span class="line">    P_bar = P_bar .* <span class="built_in">repmat</span>(b./ v,[m,<span class="number">1</span>]); <span class="comment">% scale cols</span></span><br><span class="line">    </span><br><span class="line">    error = <span class="built_in">max</span>((sum(P_bar,<span class="number">2</span>) - a));      <span class="comment">% check error</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">disp</span>([<span class="string">&#x27;error = &#x27;</span>, num2str(error)]);</span><br><span class="line">    <span class="keyword">if</span>(error &lt; epslion || counter &gt; max_iters)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    counter = counter + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> <span class="comment">%end function</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ä½œè€…é‡‡ç”¨<strong>å¯¹æ•°ç©ºé—´</strong>çš„<code>sinkhorn algorithm</code>ç®—æ³•ï¼Œæ‰€ä»¥åœ¨å®Œæˆç®—æ³•è¿­ä»£ä¹‹åéœ€è¦å¯¹<strong>ç»“æœè¿›è¡ŒæŒ‡æ•°è¿ç®—æ‰èƒ½å¾—åˆ°åˆ†é…çŸ©é˜µ</strong>ã€‚</p>
<p>ä½œè€…Sarlinæä¾›çš„ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">log_optimal_transport</span>(<span class="params">scores: torch.Tensor, alpha: torch.Tensor, iters: <span class="built_in">int</span></span>) -&gt; torch.Tensor:</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Perform Differentiable Optimal Transport in Log-space for stability&quot;&quot;&quot;</span></span><br><span class="line">    b, m, n = scores.shape</span><br><span class="line">    one = scores.new_tensor(<span class="number">1</span>)</span><br><span class="line">    ms, ns = (m*one).to(scores), (n*one).to(scores)</span><br><span class="line"></span><br><span class="line">    bins0 = alpha.expand(b, m, <span class="number">1</span>)</span><br><span class="line">    bins1 = alpha.expand(b, <span class="number">1</span>, n)</span><br><span class="line">    alpha = alpha.expand(b, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    couplings = torch.cat([torch.cat([scores, bins0], -<span class="number">1</span>),</span><br><span class="line">                           torch.cat([bins1, alpha], -<span class="number">1</span>)], <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    norm = - (ms + ns).log()</span><br><span class="line">    log_mu = torch.cat([norm.expand(m), ns.log()[<span class="literal">None</span>] + norm])</span><br><span class="line">    log_nu = torch.cat([norm.expand(n), ms.log()[<span class="literal">None</span>] + norm])</span><br><span class="line">    log_mu, log_nu = log_mu[<span class="literal">None</span>].expand(b, -<span class="number">1</span>), log_nu[<span class="literal">None</span>].expand(b, -<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    Z = log_sinkhorn_iterations(couplings, log_mu, log_nu, iters)</span><br><span class="line">    Z = Z - norm  <span class="comment"># multiply probabilities by M+N</span></span><br><span class="line">    <span class="keyword">return</span> Z</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">log_sinkhorn_iterations</span>(<span class="params">Z, log_mu, log_nu, iters: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Perform Sinkhorn Normalization in Log-space for stability&quot;&quot;&quot;</span></span><br><span class="line">    u, v = torch.zeros_like(log_mu), torch.zeros_like(log_nu)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(iters):</span><br><span class="line">        u = log_mu - torch.logsumexp(Z + v.unsqueeze(<span class="number">1</span>), dim=<span class="number">2</span>)</span><br><span class="line">        v = log_nu - torch.logsumexp(Z + u.unsqueeze(<span class="number">2</span>), dim=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> Z + u.unsqueeze(<span class="number">2</span>) + v.unsqueeze(<span class="number">1</span>)    </span><br></pre></td></tr></table></figure></p>
<h3 id="loss">Loss</h3>
<p>GNNç½‘ç»œä»¥åŠæœ€ä¼˜åŒ¹é…å±‚éƒ½æ˜¯å¯å¾®çš„ï¼Œè¿™ä½¿å¾—åå‘ä¼ æ’­è®­ç»ƒæˆä¸ºå¯èƒ½ã€‚ç½‘ç»œè®­ç»ƒä½¿ç”¨äº†ä¸€ç§ç›‘ç£å­¦ä¹ çš„æ–¹å¼ï¼Œå³æœ‰äº†åŒ¹é…çš„çœŸå€¼<span
class="math inline">\(\mathcal{M}=\{(i, j)\} \subset \mathcal{A} \times
\mathcal{B}\)</span>ï¼ˆå¦‚ï¼Œç”±çœŸå€¼ç›¸å¯¹ä½å§¿å˜æ¢å¾—åˆ°çš„åŒ¹é…å…³ç³»ï¼‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è·å¾—ä¸€äº›æ²¡æœ‰åŒ¹é…çš„ç‰¹å¾ç‚¹<span
class="math inline">\(\mathcal{I} \subseteq \mathcal{A}\)</span>ä»¥åŠ$
<span
class="math inline">\(ã€‚å½“ç»™å®šçœŸå€¼æ ‡ç­¾ï¼Œå°±å¯ä»¥å»æœ€å°åŒ–åˆ†é…çŸ©é˜µ\)</span>$
è´Ÿå¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š <span class="math display">\[
\begin{aligned} \operatorname{Loss}=&amp;-\sum_{(i, j) \in \mathcal{M}}
\log \overline{\mathbf{P}}_{i, j} \\ &amp;-\sum_{i \in \mathcal{I}} \log
\overline{\mathbf{P}}_{i, N+1}-\sum_{j \in \mathcal{J}} \log
\overline{\mathbf{P}}_{M+1, j} \end{aligned}
\]</span>
è¿™ä¸ªç›‘ç£å­¦ä¹ çš„ç›®æ ‡æ˜¯åŒæ—¶æœ€å¤§åŒ–ç²¾åº¦ä»¥åŠåŒ¹é…çš„å¬å›ç‡ï¼Œæ¥ä¸‹æ¥çš„è®­ç»ƒè¿‡ç¨‹ç•¥è¿‡ï¼Œç›´æ¥å¼€å§‹å®éªŒé˜¶æ®µçš„ä»‹ç»ã€‚</p>
<h2 id="å®éªŒ">å®éªŒ</h2>
<p>ç‰¹å¾åŒ¹é…çš„ç›®çš„æ˜¯ä¸ºäº†è§£ç®—å‡ºä¸¤å¸§ä¹‹é—´çš„ç›¸å¯¹ä½å§¿ï¼Œæ‰€ä»¥å®éªŒå¯¹æ¯”çš„ä¸€ä¸ªæŒ‡æ ‡å°±æ˜¯<strong>å•åº”çŸ©é˜µ</strong>ä¼°è®¡ï¼Œå¦å¤–è¿˜æœ‰å®¤å†…å¤–çš„ä½å§¿ä¼°è®¡ã€‚åªèƒ½è¯´SuperGlueçš„æ•ˆæœå¤ªå¥½äº†ï¼Œç›´æ¥æ”¾ç»“æœå§ï¼ˆæœ¬æ¥è®ºæ–‡7é¡µå°±å†™å®Œäº†ï¼Œä½œè€…æ”¾äº†10é¡µé™„å½•å¤§æ‹›ï¼‰ã€‚</p>
<h3 id="å•åº”çŸ©é˜µä¼°è®¡">å•åº”çŸ©é˜µä¼°è®¡</h3>
<p>èƒ½å¤Ÿè·å¾—éå¸¸é«˜çš„åŒ¹é…å¬å›ç‡ï¼ˆ98.3%ï¼‰åŒæ—¶è·å¾—è¶…é«˜çš„ç²¾åº¦ï¼Œæ¯”ä¼ ç»Ÿçš„æš´åŠ›åŒ¹é…éƒ½å¥½äº†ä¸€å¤§æˆªã€‚</p>
<figure>
<img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_tb_1.png"
alt="superglue_tb_1" />
<figcaption aria-hidden="true">superglue_tb_1</figcaption>
</figure>
<h3 id="å®¤å†…å¤–ä½å§¿ä¼°è®¡">å®¤å†…å¤–ä½å§¿ä¼°è®¡</h3>
<p>ä¸‹è¡¨çœ‹æ¥ï¼Œå¤§åŸºçº¿å®¤å†…ä½å§¿ä¼°è®¡ä¹Ÿæ˜¯ç›¸å½“æ£’ï¼Œå®Œèƒœä¼ ç»Ÿç®—æ³•ã€‚</p>
<figure>
<img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_tb_2.png"
alt="superglue_tb_2" />
<figcaption aria-hidden="true">superglue_tb_2</figcaption>
</figure>
<figure>
<img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_tb_3.png"
alt="superglue_tb_3" />
<figcaption aria-hidden="true">superglue_tb_3</figcaption>
</figure>
<h3 id="ç½‘ç»œè€—æ—¶">ç½‘ç»œè€—æ—¶</h3>
<p>æ¥ä¸‹æ¥æ”¾å‡ºå¤§å®¶æ¯”è¾ƒå…³å¿ƒçš„ç½‘ç»œè€—æ—¶ï¼Œä¸‹å›¾æ˜¯åœ¨NVIDIA GeForce GTX 1080
GPUè·‘äº†500æ¬¡çš„ç»“æœï¼Œ512ä¸ªç‚¹69msï¼ˆ14.5fpsï¼‰ï¼Œ1024ä¸ªç‚¹87msï¼ˆ11.5fpsï¼‰ã€‚</p>
<figure>
<img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_fig_11.png"
alt="superglue_tb_3" />
<figcaption aria-hidden="true">superglue_tb_3</figcaption>
</figure>
<h3 id="æ›´å¤šåŒ¹é…ç»“æœ">æ›´å¤šåŒ¹é…ç»“æœ</h3>
<p>ç¬¬ä¸€åˆ—æ˜¯SuperPoint+æš´åŠ›åŒ¹é…ç»“æœï¼Œç¬¬äºŒåˆ—æ˜¯SuperPoint+OAnetï¼ˆICCV
2019ï¼‰ç»“æœï¼Œç¬¬ä¸‰åˆ—æ˜¯SuperPoint+SuperGlueç»“æœã€‚èƒ½çœ‹åˆ°SuperGlueæƒŠäººçš„ç‰¹å¾åŒ¹é…èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯åœ¨å¤§è§†è§’å˜åŒ–æ—¶ä¼˜åŠ¿æ˜æ˜¾ï¼ˆçº¢çº¿è¡¨ç¤ºé”™è¯¯åŒ¹é…ï¼Œç»¿çº¿è¡¨ç¤ºæ­£ç¡®åŒ¹é…ï¼‰ã€‚</p>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_res_3.jpg" /></p>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_res_1.jpg" /></p>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue_res_2.jpg" /></p>
<h2 id="ç»“è®º">ç»“è®º</h2>
<p>æœ¬æ–‡å±•ç¤ºäº†åŸºäºæ³¨æ„åŠ›çš„å›¾ç¥ç»ç½‘ç»œå¯¹å±€éƒ¨ç‰¹å¾åŒ¹é…çš„å¼ºå¤§åŠŸèƒ½ã€‚
SuperGlueçš„æ¡†æ¶ä½¿ç”¨ä¸¤ç§æ³¨æ„åŠ›ï¼šï¼ˆiï¼‰è‡ªæˆ‘æ³¨æ„åŠ›ï¼Œå¯ä»¥å¢å¼ºå±€éƒ¨æè¿°ç¬¦çš„æ¥å—åŠ›ï¼›ä»¥åŠï¼ˆiiï¼‰äº¤å‰æ³¨æ„åŠ›ï¼Œå¯ä»¥å®ç°è·¨å›¾åƒäº¤æµï¼Œå¹¶å—åˆ°äººç±»æ¥å›è§‚å¯Ÿæ–¹å¼çš„å¯å‘è¿›è¡ŒåŒ¹é…å›¾åƒã€‚æ–‡ä¸­æ–¹æ³•é€šè¿‡è§£å†³<strong>æœ€ä¼˜è¿è¾“é—®é¢˜</strong>ï¼Œä¼˜é›…åœ°å¤„ç†äº†ç‰¹å¾åˆ†é…é—®é¢˜ä»¥åŠé®æŒ¡ç‚¹ã€‚å®éªŒè¡¨æ˜ï¼ŒSuperGlueä¸ç°æœ‰æ–¹æ³•ç›¸æ¯”æœ‰äº†æ˜¾ç€æ”¹è¿›ï¼Œå¯ä»¥åœ¨æå®½çš„åŸºçº¿å®¤å†…å’Œå®¤å¤–å›¾åƒå¯¹ä¸Šè¿›è¡Œé«˜ç²¾åº¦çš„ç›¸å¯¹å§¿åŠ¿ä¼°è®¡ã€‚æ­¤å¤–ï¼ŒSuperGlueå¯ä»¥å®æ—¶è¿è¡Œï¼Œå¹¶ä¸”å¯ä»¥åŒæ—¶ä½¿ç”¨ç»å…¸å’Œæ·±åº¦å­¦ä¹ ç‰¹å¾ã€‚</p>
<p>æ€»è€Œè¨€ä¹‹ï¼Œè®ºæ–‡æå‡ºçš„å¯å­¦ä¹ çš„ä¸­åç«¯ï¼ˆmiddle-endï¼‰ç®—æ³•ä»¥åŠŸèƒ½å¼ºå¤§çš„ç¥ç»ç½‘ç»œæ¨¡å‹æ›¿ä»£äº†æ‰‹å·¥å¯å‘å¼æŠ€æœ¯ï¼Œè¯¥æ¨¡å‹åŒæ—¶åœ¨å•ä¸ªç»Ÿä¸€ä½“ç³»ç»“æ„ä¸­æ‰§è¡Œä¸Šä¸‹æ–‡èšåˆï¼ŒåŒ¹é…å’Œè¿‡æ»¤å¤–ç‚¹ã€‚ä½œè€…æœ€åæåˆ°ï¼šè‹¥ä¸æ·±åº¦å­¦ä¹ å‰ç«¯ç»“åˆä½¿ç”¨ï¼ŒSuperGlueæ˜¯è¿ˆå‘ç«¯åˆ°ç«¯æ·±åº¦å­¦ä¹ SLAMçš„é‡è¦é‡Œç¨‹ç¢‘ã€‚ï¼ˆwhen
combined with a deep front-end, SuperGlue is a major milestone towards
end-to-end deep SLAMï¼‰</p>
<p>è¿™çœŸæ˜¯é¼“èˆSLAMç ”ç©¶äººå‘˜çš„å£«æ°”ï¼</p>
<p>é¡ºä¾¿ç»™ä¸ªSuperGlueä»£ç çš„æµç¨‹æ¡†å›¾ï¼š</p>
<p><img data-src="https://vincentqin.tech/blog-resources/superglue/superglue-workflow.jpg" /></p>
<h2 id="æ”¹è¿›ç‚¹-update-2022.05.17">æ”¹è¿›ç‚¹ (Update: 2022.05.17)</h2>
<p>ä¸»è¦ä»<strong>æ”¹è¿›ç‰¹å¾ç¼–ç å½¢å¼ï¼Œattentionå½¢å¼ï¼Œæ”¹è¿›æœ€ä¼˜ä¼ è¾“é—®é¢˜çš„æ±‚è§£ç­–ç•¥</strong>ç­‰è§’åº¦è¿›è¡Œå±•å¼€ã€‚</p>
<ul>
<li><p><strong>A Unified Framework for Implicit Sinkhorn
Differentiation</strong>ï¼ŒCVPR
2022ï¼Œï¼Œåˆ†æäº†æ·±åº¦å­¦ä¹ ä¸­ä»»åŠ¡ä¸­é€šç”¨<code>Sinkhorn</code>å±‚çš„éšå«æ¢¯åº¦çš„ä½¿ç”¨ï¼Œæ–‡ä¸­æŒ‡å‡ºSuperGlueä¸­ä½¿ç”¨çš„æ˜¯è‡ªåŠ¨å¾®åˆ†çš„<code>sinkhorn algorithm</code>ï¼Œæ”¶æ•›é€Ÿåº¦å¯èƒ½è¾ƒæ…¢ä¸”å®¹æ˜“å‡ºç°OOMï¼Œè€Œæœ¬ç®—æ³•èƒ½å¤Ÿè§£å†³è¯¥é—®é¢˜(ä¸è¿‡å¹¶æ²¡æœ‰è¿›è¡ŒéªŒè¯)
** [<a
target="_blank" rel="noopener" href="https://github.com/marvin-eisenberger/implicit-sinkhorn">Code</a>]**</p></li>
<li><p><strong>OpenGlue - Open Source Pipeline for Image
Matching</strong>ï¼ŒarXiv
2022ï¼Œå¤ç°äº†SuperGlueï¼ŒåŒ…æ‹¬è®­ç»ƒä»¥åŠæ¨ç†è¿‡ç¨‹ï¼ŒOpenGlueå¯¹åŸºäºå›¾çš„åŒ¹é…è¿‡ç¨‹è¿›è¡Œæ¦‚å†µï¼Œå½¢æˆäº†ä¸€å¥—æ˜“æ›¿æ¢å’Œåç»­å¼€å‘çš„æ¨¡å—å’Œæµç¨‹ï¼›æ­¤å¤–åŸºäºä¸Šè¿°æµç¨‹å¯¹SuperGlueä¸­attentionç­‰æ­¥éª¤è¿›è¡Œæ”¹è¿›ï¼›å¼€æºåè®®æœ‰æ›´æ–°ï¼ŒOpenGlueå¯å•†ç”¨
** [<a target="_blank" rel="noopener" href="https://github.com/ucuapps/OpenGlue">Code</a>]**</p></li>
<li><p><strong>MatchFormer: Interleaving Attention in Transformers for
Feature Matching</strong>ï¼ŒarXiv 2022ï¼Œæ”¹è¿›çš„LoFTRï¼Œ
å°†attentionå¼•å…¥ç‰¹å¾ç¼–ç é˜¶æ®µï¼Œå¤§å¹…åº¦æå‡ç‰¹å¾åŒ¹é…åœ¨å¤§è§†è§’å˜åŒ–æ—¶çš„åŒ¹é…æ€§èƒ½
** [<a
target="_blank" rel="noopener" href="https://github.com/jamycheung/MatchFormer">Code</a>]**</p></li>
<li><p><strong>LoFTR: Detector-Free Local Feature Matching with
Transformers</strong>, CVPR 2021ï¼Œæ— ç‰¹å¾åŒ¹é…ï¼ŒåŒ¹é…æ€§èƒ½å¼ºåŠ² <strong>[<a
target="_blank" rel="noopener" href="https://github.com/zju3dv/LoFTR">Code</a>]</strong></p></li>
<li><p><strong>valgur/SuperGluePretrainedNetwork</strong>, å®ç°äº† C++
è°ƒç”¨ SuperGlueï¼šåŒ…å«ä½¿ç”¨ <a
target="_blank" rel="noopener" href="https://pytorch.org/docs/stable/generated/torch.jit.script.html">jit
scripts</a> å°†SuperPointä»¥åŠSuperGlueåºåˆ—åŒ–ï¼Œç„¶åä½¿ç”¨pytorchçš„ C++
æ¥å£è¿›è¡Œè°ƒç”¨ <strong>[<a
target="_blank" rel="noopener" href="https://github.com/valgur/SuperGluePretrainedNetwork">Code</a>]</strong></p></li>
<li><p><strong>SuperGlue with Physarum Dynamics</strong>,
æœ€ä¼˜ä¼ è¾“é—®é¢˜çš„æ±‚è§£ç”±Sinkhorn Algorithm æ›¿æ¢æˆ <a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2004.14539">Physarum Dynamics solver</a>
<strong>[<a
target="_blank" rel="noopener" href="https://github.com/HeatherJiaZG/Superglue-with-Physarum-Dynamics">Code</a>]</strong></p></li>
<li><p><strong>Superglue-Jittor</strong>ï¼Œæ”¹è¿›äº†å›¾æ³¨æ„åŠ›æœºåˆ¶ä¸­çŸ©é˜µè¿ç®—ï¼Œé‡‡ç”¨åˆ†å—ä¼˜åŒ–çš„æ–¹å¼è¿›è¡Œï¼Œé™ä½äº†åŒ¹é…è¿‡ç¨‹ä¸­çš„æ˜¾å­˜å ç”¨ï¼›ä½¿ç”¨<code>dual-Softmax</code>
æ›¿æ¢ <code>sinkhorn algorithm</code> <strong>[<a
target="_blank" rel="noopener" href="https://github.com/smy-THU/superglue-jittor">Code</a>]</strong></p></li>
<li><p><strong>SuperGlue PyTorch
Implementation</strong>ï¼Œpytorchå¤ç°SuperGlue <strong>[<a
target="_blank" rel="noopener" href="https://github.com/HeatherJiaZG/SuperGlue-pytorch">Code</a>]</strong></p></li>
<li><p><strong>MNNSuperGlue</strong>ï¼ŒMNN Superglue å…³é”®ç‚¹åŒ¹é…C++å®ç°
<strong>[<a
target="_blank" rel="noopener" href="https://github.com/Hanson0910/MNNSuperGlue">Code</a>]</strong></p></li>
</ul>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a
target="_blank" rel="noopener" href="https://github.com/magicleap/SuperGluePretrainedNetwork">SuperGlue
æºç </a></li>
<li><a target="_blank" rel="noopener" href="http://xxx.itp.ac.cn/pdf/1911.11763v2">SuperGlue
Paper</a></li>
<li><a target="_blank" rel="noopener" href="https://image-matching-workshop.github.io/">Image Matching:
Local Features &amp; Beyond CVPR 2020 Workshop</a></li>
<li><a
target="_blank" rel="noopener" href="http://huitaofuwu.com/2020/08/19/%E5%88%9D%E6%8E%A2GNN-SuperGLue%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/">åˆæ¢GNN&amp;SuperGLueé˜…è¯»ç¬”è®°</a></li>
<li><a
target="_blank" rel="noopener" href="https://blog.csdn.net/shizhuoduao/article/details/107120805">SuperGlue:Learning
Feature Matching with Graph Neural Networks è§£è¯»ä¸å®éªŒ</a></li>
</ul>
<!-- ---

![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_01.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_02.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_03.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_04.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_05.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_06.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_07.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_08.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_09.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_10.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_11.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_12.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_13.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_14.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_15.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_16.png)
![](https://gitee.com/vincentqin/BlogResource-5/raw/master/superglue/superglue_paper/SuperGlue.pdf_page_17.png) -->

    </div>

    
    
    
      


    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Vincent Qin
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://www.vincentqin.tech/posts/superglue/" title="ğŸ“ç¬”è®°ï¼šSuperGlue:Learning Feature Matching with Graph Neural Networksè®ºæ–‡é˜…è¯»">https://www.vincentqin.tech/posts/superglue/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/SLAM/" rel="tag"># SLAM</a>
              <a href="/tags/%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96/" rel="tag"># ç‰¹å¾æå–</a>
              <a href="/tags/Deep-Learning/" rel="tag"># Deep Learning</a>
              <a href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag"># ç¬”è®°</a>
              <a href="/tags/%E8%AE%BA%E6%96%87/" rel="tag"># è®ºæ–‡</a>
              <a href="/tags/SuperGlue/" rel="tag"># SuperGlue</a>
              <a href="/tags/MagicLeap/" rel="tag"># MagicLeap</a>
              <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag"># æ·±åº¦å­¦ä¹ </a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/slam-common-issues-SVD/" rel="prev" title="ğŸ“ç¬”è®°ï¼šSLAMå¸¸è§é—®é¢˜(äº”)ï¼šSingular Value Decompositionï¼ˆSVDï¼‰åˆ†è§£">
                  <i class="fa fa-chevron-left"></i> ğŸ“ç¬”è®°ï¼šSLAMå¸¸è§é—®é¢˜(äº”)ï¼šSingular Value Decompositionï¼ˆSVDï¼‰åˆ†è§£
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/2020-image-matching-cvpr/" rel="next" title="ğŸ“ç¬”è®°ï¼šCVPR2020å›¾åƒåŒ¹é…æŒ‘æˆ˜èµ›ï¼Œæ–°æ•°æ®é›†+æ–°è¯„æµ‹æ–¹æ³•ï¼ŒSOTAæ­£ç‘Ÿç‘Ÿå‘æŠ–ï¼">
                  ğŸ“ç¬”è®°ï¼šCVPR2020å›¾åƒåŒ¹é…æŒ‘æˆ˜èµ›ï¼Œæ–°æ•°æ®é›†+æ–°è¯„æµ‹æ–¹æ³•ï¼ŒSOTAæ­£ç‘Ÿç‘Ÿå‘æŠ–ï¼ <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2016 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Vincent Qin</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.8/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.6/mermaid.min.js","integrity":"sha256-ZfzwelSToHk5YAcr9wbXAmWgyn9Jyq08fSLrLhZE89w="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>



  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"en-US","enable":true,"serverURL":"https://comments.vincentqin.tech","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":true,"locale":{"placeholder":"Welcome to comment"},"emoji":["https://unpkg.com/@waline/emojis@1.1.0/weibo","https://unpkg.com/@waline/emojis@1.1.0/alus","https://unpkg.com/@waline/emojis@1.1.0/bilibili","https://unpkg.com/@waline/emojis@1.1.0/qq","https://unpkg.com/@waline/emojis@1.1.0/tieba","https://unpkg.com/@waline/emojis@1.1.0/tw-emoji"],"meta":["nick","mail","link"],"requiredMeta":["nick","mail"],"wordLimit":0,"login":"enable","el":"#waline","comment":true,"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","path":"/posts/superglue/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

</body>
</html>
